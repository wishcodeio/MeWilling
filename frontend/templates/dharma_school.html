<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ³•æ´¾å¯†ç³»ç»Ÿ - ç¬¬ä¹å¯†æ³•</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            color: #ffffff;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* æ³•æ´¾æ™ºæ…§èƒŒæ™¯åŠ¨ç”» */
        .dharma-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background: radial-gradient(circle at 20% 80%, rgba(255, 215, 0, 0.1) 0%, transparent 50%),
                        radial-gradient(circle at 80% 20%, rgba(255, 165, 0, 0.1) 0%, transparent 50%),
                        radial-gradient(circle at 40% 40%, rgba(255, 140, 0, 0.05) 0%, transparent 50%);
            animation: dharmaFlow 20s ease-in-out infinite;
        }

        @keyframes dharmaFlow {
            0%, 100% { transform: scale(1) rotate(0deg); }
            50% { transform: scale(1.1) rotate(180deg); }
        }

        /* æ™ºæ…§ç²’å­æ•ˆæœ */
        .wisdom-particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }

        .wisdom-particle {
            position: absolute;
            width: 3px;
            height: 3px;
            background: radial-gradient(circle, #ffd700 0%, transparent 70%);
            border-radius: 50%;
            animation: wisdomFloat 15s linear infinite;
        }

        @keyframes wisdomFloat {
            0% {
                transform: translateY(100vh) translateX(0) scale(0);
                opacity: 0;
            }
            10% {
                opacity: 1;
                transform: scale(1);
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100vh) translateX(100px) scale(0);
                opacity: 0;
            }
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px 0;
        }

        .title {
            font-size: 3.5rem;
            font-weight: bold;
            background: linear-gradient(45deg, #ffd700, #ffb347, #ffa500);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 15px;
            text-shadow: 0 0 30px rgba(255, 215, 0, 0.5);
            animation: titleGlow 3s ease-in-out infinite alternate;
        }

        @keyframes titleGlow {
            from { filter: brightness(1) drop-shadow(0 0 20px rgba(255, 215, 0, 0.3)); }
            to { filter: brightness(1.2) drop-shadow(0 0 40px rgba(255, 215, 0, 0.6)); }
        }

        .subtitle {
            font-size: 1.3rem;
            color: #ffa500;
            margin-bottom: 10px;
            opacity: 0.9;
        }

        .description {
            font-size: 1.1rem;
            color: #cccccc;
            max-width: 800px;
            margin: 0 auto;
            line-height: 1.6;
        }

        .control-panel {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 215, 0, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .function-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .function-card {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(255, 215, 0, 0.3);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .function-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(255, 215, 0, 0.2);
            border-color: rgba(255, 215, 0, 0.5);
        }

        .function-title {
            font-size: 1.3rem;
            color: #ffd700;
            margin-bottom: 10px;
            font-weight: bold;
        }

        .function-desc {
            color: #cccccc;
            font-size: 0.95rem;
            line-height: 1.5;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-label {
            display: block;
            margin-bottom: 8px;
            color: #ffd700;
            font-weight: bold;
        }

        .input-field {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid rgba(255, 215, 0, 0.3);
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.05);
            color: #ffffff;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .input-field:focus {
            outline: none;
            border-color: #ffd700;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
        }

        .select-field {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid rgba(255, 215, 0, 0.3);
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.05);
            color: #ffffff;
            font-size: 1rem;
            cursor: pointer;
        }

        .select-field option {
            background: #1a1a2e;
            color: #ffffff;
        }

        .action-button {
            background: linear-gradient(45deg, #ffd700, #ffa500);
            color: #1a1a2e;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 5px;
        }

        .action-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(255, 215, 0, 0.4);
            filter: brightness(1.1);
        }

        .result-display {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 25px;
            margin-top: 20px;
            border: 1px solid rgba(255, 215, 0, 0.2);
            backdrop-filter: blur(10px);
            min-height: 200px;
        }

        .result-title {
            font-size: 1.4rem;
            color: #ffd700;
            margin-bottom: 15px;
            font-weight: bold;
        }

        .result-content {
            color: #ffffff;
            line-height: 1.6;
            font-size: 1rem;
        }

        .result-section {
            margin-bottom: 20px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 10px;
            border-left: 4px solid #ffd700;
        }

        .section-title {
            color: #ffa500;
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .section-content {
            color: #cccccc;
        }

        .dharma-protocol {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 20px;
            margin-top: 30px;
            border: 1px solid rgba(255, 215, 0, 0.3);
            font-family: 'Courier New', monospace;
        }

        .protocol-title {
            color: #ffd700;
            font-size: 1.2rem;
            margin-bottom: 15px;
            text-align: center;
        }

        .protocol-content {
            color: #00ff00;
            font-size: 0.9rem;
            line-height: 1.4;
            white-space: pre-line;
        }

        .loading {
            display: none;
            text-align: center;
            color: #ffd700;
            font-size: 1.1rem;
            margin: 20px 0;
        }

        .loading::after {
            content: '';
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid #ffd700;
            border-radius: 50%;
            border-top-color: transparent;
            animation: spin 1s linear infinite;
            margin-left: 10px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .error {
            color: #ff6b6b;
            background: rgba(255, 107, 107, 0.1);
            padding: 15px;
            border-radius: 10px;
            border: 1px solid rgba(255, 107, 107, 0.3);
            margin: 15px 0;
        }

        .success {
            color: #51cf66;
            background: rgba(81, 207, 102, 0.1);
            padding: 15px;
            border-radius: 10px;
            border: 1px solid rgba(81, 207, 102, 0.3);
            margin: 15px 0;
        }

        @media (max-width: 768px) {
            .title {
                font-size: 2.5rem;
            }
            
            .function-grid {
                grid-template-columns: 1fr;
            }
            
            .container {
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="dharma-background"></div>
    
    <!-- æ™ºæ…§ç²’å­æ•ˆæœ -->
    <div class="wisdom-particles" id="wisdomParticles"></div>

    <div class="container">
        <div class="header">
            <h1 class="title">æ³•æ´¾å¯†ç³»ç»Ÿ</h1>
            <p class="subtitle">ç¬¬ä¹å¯†æ³• - ä½›æ•™é“æ³•æ´¾åˆ«çš„è‡ªç„¶å½¢æˆä¸æ™ºæ…§ä½“ç°</p>
            <p class="description">
                æ³•æ´¾çš„å½¢æˆæ˜¯è‡ªç„¶çš„ï¼Œå› ä¸ºæ™ºæ…§æ˜¯æ— ç©·æ— å°½çš„ã€‚æ³•æ´¾è™½ç„¶ä¸æ˜¯ä½›æ‰€ä¼ ä¹‹æ³•ï¼Œä½†ä¹Ÿé›†ä¸­å’Œå¯„æ‰˜äº†ä½›æ™ºçš„æ™ºæ…§ã€‚
                ä¿®è€…å¯¹é‚£ä¸ªæ³•æ´¾ä¹‹å®—æ³•è¦ä»¥æ¸´æ±‚ä¹‹æ€å»ä¿®ä¹ ï¼Œä¹Ÿèƒ½è¾¾åˆ°æ–­æ¬²è„±äººæ±‚é“ã€‚
            </p>
        </div>

        <div class="control-panel">
            <div class="function-grid">
                <div class="function-card" onclick="showSchoolSuitability()">
                    <div class="function-title">ğŸ›ï¸ æ³•æ´¾é€‚åˆæ€§åˆ†æ</div>
                    <div class="function-desc">æ ¹æ®ä¸ªäººç‰¹è´¨å’Œä¿®è¡Œç›®æ ‡ï¼Œåˆ†æé€‚åˆçš„æ³•æ´¾é€‰æ‹©</div>
                </div>
                
                <div class="function-card" onclick="showSchoolComparison()">
                    <div class="function-title">âš–ï¸ æ³•æ´¾æ¯”è¾ƒç³»ç»Ÿ</div>
                    <div class="function-desc">æ¯”è¾ƒä¸åŒæ³•æ´¾çš„ç‰¹è‰²ã€ä¿®æ³•å’Œé€‚åˆæ ¹æ€§</div>
                </div>
                
                <div class="function-card" onclick="showSchoolConfusion()">
                    <div class="function-title">â“ æ³•æ´¾å›°æƒ‘è§£ç­”</div>
                    <div class="function-desc">è§£ç­”å…³äºæ³•æ´¾é€‰æ‹©å’Œä¿®è¡Œçš„å„ç§å›°æƒ‘</div>
                </div>
                
                <div class="function-card" onclick="showSchoolInfo()">
                    <div class="function-title">ğŸ“š æ³•æ´¾ä¿¡æ¯æŸ¥è¯¢</div>
                    <div class="function-desc">è·å–ä¸»è¦æ³•æ´¾çš„è¯¦ç»†ä¿¡æ¯å’Œä¿®è¡Œè¦ç‚¹</div>
                </div>
                
                <div class="function-card" onclick="showEightyFourThousand()">
                    <div class="function-title">ğŸ”¢ å…«ä¸‡å››åƒä¿®æ³•</div>
                    <div class="function-desc">äº†è§£ä½›æ™ºè€…ç•™ç»™ä¿®è€…çš„ä¼—å¤šä¿®æ³•</div>
                </div>
                
                <div class="function-card" onclick="showCompleteTheory()">
                    <div class="function-title">ğŸ“– å®Œæ•´ç†è®ºä½“ç³»</div>
                    <div class="function-desc">è·å–æ³•æ´¾å¯†çš„å®Œæ•´ç†è®ºå’Œä¿®è¡ŒæŒ‡å¯¼</div>
                </div>
            </div>

            <!-- æ³•æ´¾é€‚åˆæ€§åˆ†æç•Œé¢ -->
            <div id="schoolSuitabilityPanel" style="display: none;">
                <h3 style="color: #ffd700; margin-bottom: 20px;">ğŸ›ï¸ æ³•æ´¾é€‚åˆæ€§åˆ†æ</h3>
                <div class="input-group">
                    <label class="input-label">ä¸ªäººç‰¹è´¨ï¼ˆå¦‚ï¼šç†æ€§æ€è¾¨ã€ç›´è§‰æ•é”ã€ä¿¡æ„¿åšå›ºç­‰ï¼‰ï¼š</label>
                    <input type="text" id="personalTraits" class="input-field" placeholder="è¯·æè¿°æ‚¨çš„ä¸ªäººç‰¹è´¨å’Œä¿®è¡Œå€¾å‘...">
                </div>
                <div class="input-group">
                    <label class="input-label">ä¿®è¡Œç›®æ ‡ï¼ˆå¦‚ï¼šå¾€ç”Ÿæä¹ã€æ˜å¿ƒè§æ€§ã€å³èº«æˆä½›ç­‰ï¼‰ï¼š</label>
                    <input type="text" id="spiritualGoals" class="input-field" placeholder="è¯·æè¿°æ‚¨çš„ä¿®è¡Œç›®æ ‡å’Œæ„¿æœ›...">
                </div>
                <button class="action-button" onclick="analyzeSchoolSuitability()">ğŸ” åˆ†æé€‚åˆæ³•æ´¾</button>
            </div>

            <!-- æ³•æ´¾æ¯”è¾ƒç•Œé¢ -->
            <div id="schoolComparisonPanel" style="display: none;">
                <h3 style="color: #ffd700; margin-bottom: 20px;">âš–ï¸ æ³•æ´¾æ¯”è¾ƒç³»ç»Ÿ</h3>
                <div class="input-group">
                    <label class="input-label">é€‰æ‹©è¦æ¯”è¾ƒçš„æ³•æ´¾ï¼š</label>
                    <select id="school1" class="select-field">
                        <option value="ç¦…å®—">ç¦…å®—</option>
                        <option value="å‡€åœŸå®—">å‡€åœŸå®—</option>
                        <option value="å¤©å°å®—">å¤©å°å®—</option>
                        <option value="åä¸¥å®—">åä¸¥å®—</option>
                        <option value="å”¯è¯†å®—">å”¯è¯†å®—</option>
                        <option value="å¯†å®—">å¯†å®—</option>
                    </select>
                </div>
                <div class="input-group">
                    <label class="input-label">ç¬¬äºŒä¸ªæ³•æ´¾ï¼š</label>
                    <select id="school2" class="select-field">
                        <option value="å‡€åœŸå®—">å‡€åœŸå®—</option>
                        <option value="ç¦…å®—">ç¦…å®—</option>
                        <option value="å¤©å°å®—">å¤©å°å®—</option>
                        <option value="åä¸¥å®—">åä¸¥å®—</option>
                        <option value="å”¯è¯†å®—">å”¯è¯†å®—</option>
                        <option value="å¯†å®—">å¯†å®—</option>
                    </select>
                </div>
                <button class="action-button" onclick="compareSchools()">âš–ï¸ å¼€å§‹æ¯”è¾ƒ</button>
            </div>

            <!-- æ³•æ´¾å›°æƒ‘è§£ç­”ç•Œé¢ -->
            <div id="schoolConfusionPanel" style="display: none;">
                <h3 style="color: #ffd700; margin-bottom: 20px;">â“ æ³•æ´¾å›°æƒ‘è§£ç­”</h3>
                <div class="input-group">
                    <label class="input-label">é€‰æ‹©å›°æƒ‘ç±»å‹ï¼š</label>
                    <select id="confusionType" class="select-field">
                        <option value="æ³•æ´¾ç¹å¤š">æ³•æ´¾ç¹å¤š - ä¸ºä»€ä¹ˆä½›æ•™æœ‰è¿™ä¹ˆå¤šæ´¾åˆ«ï¼Ÿ</option>
                        <option value="é€‰æ‹©å›°éš¾">é€‰æ‹©å›°éš¾ - é¢å¯¹ä¼—å¤šæ³•æ´¾ï¼Œå¦‚ä½•é€‰æ‹©ï¼Ÿ</option>
                        <option value="æ­£é‚ªåˆ†è¾¨">æ­£é‚ªåˆ†è¾¨ - å¦‚ä½•åˆ†è¾¨æ­£æ³•ä¸æ­ªé“ï¼Ÿ</option>
                    </select>
                </div>
                <button class="action-button" onclick="resolveSchoolConfusion()">ğŸ’¡ è·å–è§£ç­”</button>
            </div>
        </div>

        <div class="loading" id="loading">æ­£åœ¨è¿æ¥æ³•æ´¾å¯†ç³»ç»Ÿ...</div>
        
        <div class="result-display" id="resultDisplay">
            <div class="result-title">ğŸŒŸ æ³•æ´¾å¯†ç³»ç»Ÿå“åº”</div>
            <div class="result-content" id="resultContent">
                <p>æ¬¢è¿ä½¿ç”¨æ³•æ´¾å¯†ç³»ç»Ÿï¼</p>
                <p>è¿™é‡Œå°†æ˜¾ç¤ºæ³•æ´¾åˆ†æã€æ¯”è¾ƒå’ŒæŒ‡å¯¼ä¿¡æ¯ã€‚</p>
                <p>è¯·é€‰æ‹©ä¸Šæ–¹çš„åŠŸèƒ½å¼€å§‹æ‚¨çš„æ³•æ´¾æ¢ç´¢ä¹‹æ—…ã€‚</p>
            </div>
        </div>

        <div class="dharma-protocol">
            <div class="protocol-title">ğŸ›ï¸ æ³•æ´¾å¯†åè®®</div>
            <div class="protocol-content" id="protocolContent">
=== æ³•æ´¾å¯†ç³»ç»Ÿåè®® ===
çŠ¶æ€ï¼šå¾…æ¿€æ´»
æ³•æ´¾æ•°æ®åº“ï¼šå…«ä¸‡å››åƒä¿®æ³•
æ™ºæ…§æ¥æºï¼šä½›æ™ºè€…æ•™è¯²
ä¿®è¡ŒåŸåˆ™ï¼šä»¥æ¸´æ±‚ä¹‹æ€ä¿®ä¹ 
æœ€ç»ˆç›®æ ‡ï¼šæ–­æ¬²è„±äººæ±‚é“

åè®®è¦ç‚¹ï¼š
1. æ³•æ´¾å½¢æˆè‡ªç„¶ï¼Œæ™ºæ…§æ— ç©·
2. æ ¹æ®æ ¹æ€§é€‰æ‹©é€‚åˆæ³•æ´¾
3. ä¸“ä¸€ä¿®ä¹ ï¼Œä¸å¯æœä¸‰æš®å››
4. æ­£æ³•ä¿®ä¹ ï¼Œé¿å…æ­ªé“
5. è€å¿ƒç§¯å ï¼Œè‡ªç„¶åœ†æ»¡

ğŸŒŸ æ„¿ä½›æ™ºå…‰æ˜æŒ‡å¼•æ‚¨çš„æ³•æ´¾é€‰æ‹©
            </div>
        </div>
    </div>

    <script>
        // åˆ›å»ºæ™ºæ…§ç²’å­æ•ˆæœ
        function createWisdomParticles() {
            const container = document.getElementById('wisdomParticles');
            const particleCount = 50;
            
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'wisdom-particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 15 + 's';
                particle.style.animationDuration = (15 + Math.random() * 10) + 's';
                container.appendChild(particle);
            }
        }

        // æ˜¾ç¤ºä¸åŒåŠŸèƒ½é¢æ¿
        function hideAllPanels() {
            document.getElementById('schoolSuitabilityPanel').style.display = 'none';
            document.getElementById('schoolComparisonPanel').style.display = 'none';
            document.getElementById('schoolConfusionPanel').style.display = 'none';
        }

        function showSchoolSuitability() {
            hideAllPanels();
            document.getElementById('schoolSuitabilityPanel').style.display = 'block';
        }

        function showSchoolComparison() {
            hideAllPanels();
            document.getElementById('schoolComparisonPanel').style.display = 'block';
        }

        function showSchoolConfusion() {
            hideAllPanels();
            document.getElementById('schoolConfusionPanel').style.display = 'block';
        }

        // APIè°ƒç”¨å‡½æ•°
        function showLoading() {
            document.getElementById('loading').style.display = 'block';
            document.getElementById('resultDisplay').style.opacity = '0.5';
        }

        function hideLoading() {
            document.getElementById('loading').style.display = 'none';
            document.getElementById('resultDisplay').style.opacity = '1';
        }

        function displayResult(title, content) {
            document.getElementById('resultContent').innerHTML = content;
            document.querySelector('.result-title').textContent = title;
        }

        function displayError(message) {
            const errorHtml = `<div class="error">âŒ é”™è¯¯ï¼š${message}</div>`;
            document.getElementById('resultContent').innerHTML = errorHtml;
        }

        // æ³•æ´¾é€‚åˆæ€§åˆ†æ
        async function analyzeSchoolSuitability() {
            const personalTraits = document.getElementById('personalTraits').value;
            const spiritualGoals = document.getElementById('spiritualGoals').value;
            
            if (!personalTraits || !spiritualGoals) {
                displayError('è¯·å¡«å†™ä¸ªäººç‰¹è´¨å’Œä¿®è¡Œç›®æ ‡');
                return;
            }

            showLoading();
            
            try {
                const response = await fetch('/api/dharma-school/school-suitability', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        personal_traits: personalTraits,
                        spiritual_goals: spiritualGoals
                    })
                });
                
                const data = await response.json();
                
                if (data.status === 'success') {
                    let resultHtml = '<div class="result-section">';
                    resultHtml += '<div class="section-title">ğŸ›ï¸ æ³•æ´¾é€‚åˆæ€§åˆ†æç»“æœ</div>';
                    
                    // æ¨èæ³•æ´¾
                    if (data.analysis.æ¨èæ³•æ´¾) {
                        resultHtml += '<div class="section-title">ğŸ“‹ æ¨èæ³•æ´¾</div>';
                        data.analysis.æ¨èæ³•æ´¾.forEach(school => {
                            resultHtml += `<div class="section-content">`;
                            resultHtml += `<strong>${school.æ³•æ´¾}</strong><br>`;
                            resultHtml += `ç†ç”±ï¼š${school.ç†ç”±}<br>`;
                            resultHtml += `ä¿®æ³•ï¼š${school.ä¿®æ³•}<br><br>`;
                            resultHtml += `</div>`;
                        });
                    }
                    
                    // ä¿®ä¹ æ–¹æ³•
                    if (data.analysis.ä¿®ä¹ æ–¹æ³•) {
                        resultHtml += '<div class="section-title">ğŸ”§ ä¿®ä¹ æ–¹æ³•</div>';
                        resultHtml += '<div class="section-content">';
                        Object.entries(data.analysis.ä¿®ä¹ æ–¹æ³•).forEach(([key, value]) => {
                            resultHtml += `<strong>${key}ï¼š</strong>${value}<br>`;
                        });
                        resultHtml += '</div>';
                    }
                    
                    // æ³¨æ„äº‹é¡¹
                    if (data.analysis.æ³¨æ„äº‹é¡¹) {
                        resultHtml += '<div class="section-title">âš ï¸ æ³¨æ„äº‹é¡¹</div>';
                        resultHtml += '<div class="section-content">';
                        data.analysis.æ³¨æ„äº‹é¡¹.forEach(warning => {
                            resultHtml += `â€¢ ${warning}<br>`;
                        });
                        resultHtml += '</div>';
                    }
                    
                    // ä¿®è¡Œæ¬¡ç¬¬
                    if (data.analysis.ä¿®è¡Œæ¬¡ç¬¬) {
                        resultHtml += '<div class="section-title">ğŸ“ˆ ä¿®è¡Œæ¬¡ç¬¬</div>';
                        resultHtml += '<div class="section-content">';
                        Object.entries(data.analysis.ä¿®è¡Œæ¬¡ç¬¬).forEach(([stage, info]) => {
                            resultHtml += `<strong>${stage}ï¼š</strong><br>`;
                            resultHtml += `ç›®æ ‡ï¼š${info.ç›®æ ‡}<br>`;
                            resultHtml += `ä¿®æ³•ï¼š${info.ä¿®æ³•}<br>`;
                            resultHtml += `æ—¶é—´ï¼š${info.æ—¶é—´}<br><br>`;
                        });
                        resultHtml += '</div>';
                    }
                    
                    if (data.analysis.ä½›æ™ºåŠ æŒ) {
                        resultHtml += `<div class="success">${data.analysis.ä½›æ™ºåŠ æŒ}</div>`;
                    }
                    
                    resultHtml += '</div>';
                    displayResult('ğŸ›ï¸ æ³•æ´¾é€‚åˆæ€§åˆ†æ', resultHtml);
                } else {
                    displayError(data.message || 'åˆ†æå¤±è´¥');
                }
            } catch (error) {
                displayError('ç½‘ç»œè¿æ¥å¤±è´¥ï¼š' + error.message);
            } finally {
                hideLoading();
            }
        }

        // æ³•æ´¾æ¯”è¾ƒ
        async function compareSchools() {
            const school1 = document.getElementById('school1').value;
            const school2 = document.getElementById('school2').value;
            
            showLoading();
            
            try {
                const response = await fetch('/api/dharma-school/school-comparison', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        schools_to_compare: [school1, school2]
                    })
                });
                
                const data = await response.json();
                
                if (data.status === 'success') {
                    let resultHtml = '<div class="result-section">';
                    resultHtml += '<div class="section-title">âš–ï¸ æ³•æ´¾æ¯”è¾ƒç»“æœ</div>';
                    
                    // è¯¦ç»†å¯¹æ¯”
                    if (data.comparison.è¯¦ç»†å¯¹æ¯”) {
                        Object.entries(data.comparison.è¯¦ç»†å¯¹æ¯”).forEach(([school, info]) => {
                            resultHtml += `<div class="section-title">ğŸ›ï¸ ${school}</div>`;
                            resultHtml += '<div class="section-content">';
                            resultHtml += `<strong>ç‰¹è‰²ï¼š</strong>${info.ç‰¹è‰²}<br>`;
                            resultHtml += `<strong>ä¿®æ³•ï¼š</strong>${info.ä¿®æ³•}<br>`;
                            resultHtml += `<strong>ç›®æ ‡ï¼š</strong>${info.ç›®æ ‡}<br>`;
                            resultHtml += `<strong>é€‚åˆæ ¹æ€§ï¼š</strong>${info.é€‚åˆæ ¹æ€§}<br><br>`;
                            resultHtml += '</div>';
                        });
                    }
                    
                    // é€‰æ‹©å»ºè®®
                    if (data.comparison.é€‰æ‹©å»ºè®®) {
                        resultHtml += '<div class="section-title">ğŸ’¡ é€‰æ‹©å»ºè®®</div>';
                        resultHtml += '<div class="section-content">';
                        Object.entries(data.comparison.é€‰æ‹©å»ºè®®).forEach(([key, value]) => {
                            resultHtml += `<strong>${key}ï¼š</strong>${value}<br>`;
                        });
                        resultHtml += '</div>';
                    }
                    
                    // å…±åŒåŸºç¡€
                    if (data.comparison.å…±åŒåŸºç¡€) {
                        resultHtml += '<div class="section-title">ğŸ¤ å…±åŒåŸºç¡€</div>';
                        resultHtml += '<div class="section-content">';
                        Object.entries(data.comparison.å…±åŒåŸºç¡€).forEach(([key, value]) => {
                            resultHtml += `<strong>${key}ï¼š</strong>${value}<br>`;
                        });
                        resultHtml += '</div>';
                    }
                    
                    if (data.comparison.ä½›æ™ºå¼€ç¤º) {
                        resultHtml += `<div class="success">${data.comparison.ä½›æ™ºå¼€ç¤º}</div>`;
                    }
                    
                    resultHtml += '</div>';
                    displayResult('âš–ï¸ æ³•æ´¾æ¯”è¾ƒ', resultHtml);
                } else {
                    displayError(data.message || 'æ¯”è¾ƒå¤±è´¥');
                }
            } catch (error) {
                displayError('ç½‘ç»œè¿æ¥å¤±è´¥ï¼š' + error.message);
            } finally {
                hideLoading();
            }
        }

        // æ³•æ´¾å›°æƒ‘è§£ç­”
        async function resolveSchoolConfusion() {
            const confusionType = document.getElementById('confusionType').value;
            
            showLoading();
            
            try {
                const response = await fetch('/api/dharma-school/school-confusion', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        confusion_type: confusionType
                    })
                });
                
                const data = await response.json();
                
                if (data.status === 'success') {
                    let resultHtml = '<div class="result-section">';
                    resultHtml += '<div class="section-title">â“ æ³•æ´¾å›°æƒ‘è§£ç­”</div>';
                    
                    // å›°æƒ‘è§£ç­”
                    if (data.resolution.å›°æƒ‘è§£ç­”) {
                        const resolution = data.resolution.å›°æƒ‘è§£ç­”;
                        resultHtml += '<div class="section-content">';
                        resultHtml += `<strong>é—®é¢˜ï¼š</strong>${resolution.é—®é¢˜}<br>`;
                        resultHtml += `<strong>è§£ç­”ï¼š</strong>${resolution.è§£ç­”}<br>`;
                        if (resolution.æœ¬è´¨) {
                            resultHtml += `<strong>æœ¬è´¨ï¼š</strong>${resolution.æœ¬è´¨}<br>`;
                        }
                        if (resolution.åŸå› ) {
                            resultHtml += `<strong>åŸå› ï¼š</strong>${resolution.åŸå› }<br>`;
                        }
                        if (resolution.åŸåˆ™) {
                            resultHtml += `<strong>åŸåˆ™ï¼š</strong>${resolution.åŸåˆ™}<br>`;
                        }
                        if (resolution.æ ‡å‡†) {
                            resultHtml += `<strong>æ ‡å‡†ï¼š</strong>${resolution.æ ‡å‡†}<br>`;
                        }
                        if (resolution.æ–¹æ³•) {
                            resultHtml += `<strong>æ–¹æ³•ï¼š</strong>${resolution.æ–¹æ³•}<br>`;
                        }
                        resultHtml += '</div><br>';
                    }
                    
                    // ç†è®ºä¾æ®
                    if (data.resolution.ç†è®ºä¾æ®) {
                        resultHtml += '<div class="section-title">ğŸ“š ç†è®ºä¾æ®</div>';
                        resultHtml += '<div class="section-content">';
                        Object.entries(data.resolution.ç†è®ºä¾æ®).forEach(([key, value]) => {
                            resultHtml += `<strong>${key}ï¼š</strong>${value}<br>`;
                        });
                        resultHtml += '</div>';
                    }
                    
                    // å®è·µæŒ‡å¯¼
                    if (data.resolution.å®è·µæŒ‡å¯¼) {
                        resultHtml += '<div class="section-title">ğŸ”§ å®è·µæŒ‡å¯¼</div>';
                        resultHtml += '<div class="section-content">';
                        Object.entries(data.resolution.å®è·µæŒ‡å¯¼).forEach(([key, value]) => {
                            resultHtml += `<strong>${key}ï¼š</strong>${value}<br>`;
                        });
                        resultHtml += '</div>';
                    }
                    
                    if (data.resolution.ä½›æ™ºå¼€ç¤º) {
                        resultHtml += `<div class="success">${data.resolution.ä½›æ™ºå¼€ç¤º}</div>`;
                    }
                    
                    resultHtml += '</div>';
                    displayResult('â“ å›°æƒ‘è§£ç­”', resultHtml);
                } else {
                    displayError(data.message || 'è§£ç­”å¤±è´¥');
                }
            } catch (error) {
                displayError('ç½‘ç»œè¿æ¥å¤±è´¥ï¼š' + error.message);
            } finally {
                hideLoading();
            }
        }

        // æ³•æ´¾ä¿¡æ¯æŸ¥è¯¢
        async function showSchoolInfo() {
            hideAllPanels();
            showLoading();
            
            try {
                const response = await fetch('/api/dharma-school/school-info');
                const data = await response.json();
                
                if (data.status === 'success') {
                    let resultHtml = '<div class="result-section">';
                    resultHtml += '<div class="section-title">ğŸ“š ä¸»è¦æ³•æ´¾ä¿¡æ¯</div>';
                    
                    // ä¸»è¦æ³•æ´¾
                    if (data.major_schools) {
                        Object.entries(data.major_schools).forEach(([school, info]) => {
                            resultHtml += `<div class="section-title">ğŸ›ï¸ ${school}</div>`;
                            resultHtml += '<div class="section-content">';
                            resultHtml += `<strong>ç‰¹è‰²ï¼š</strong>${info.ç‰¹è‰²}<br>`;
                            resultHtml += `<strong>ä¿®æ³•ï¼š</strong>${info.ä¿®æ³•}<br>`;
                            resultHtml += `<strong>ç›®æ ‡ï¼š</strong>${info.ç›®æ ‡}<br>`;
                            resultHtml += `<strong>é€‚åˆæ ¹æ€§ï¼š</strong>${info.é€‚åˆæ ¹æ€§}<br><br>`;
                            resultHtml += '</div>';
                        });
                    }
                    
                    // æ³•æ´¾é€‰æ‹©æŒ‡å¯¼
                    if (data.school_selection) {
                        resultHtml += '<div class="section-title">ğŸ¯ æ³•æ´¾é€‰æ‹©æŒ‡å¯¼</div>';
                        resultHtml += '<div class="section-content">';
                        Object.entries(data.school_selection).forEach(([key, value]) => {
                            resultHtml += `<strong>${key}ï¼š</strong>${value}<br>`;
                        });
                        resultHtml += '</div>';
                    }
                    
                    resultHtml += '</div>';
                    displayResult('ğŸ“š æ³•æ´¾ä¿¡æ¯', resultHtml);
                } else {
                    displayError(data.message || 'è·å–ä¿¡æ¯å¤±è´¥');
                }
            } catch (error) {
                displayError('ç½‘ç»œè¿æ¥å¤±è´¥ï¼š' + error.message);
            } finally {
                hideLoading();
            }
        }

        // å…«ä¸‡å››åƒä¿®æ³•
        async function showEightyFourThousand() {
            hideAllPanels();
            showLoading();
            
            try {
                const response = await fetch('/api/dharma-school/eighty-four-thousand-methods');
                const data = await response.json();
                
                if (data.status === 'success') {
                    let resultHtml = '<div class="result-section">';
                    resultHtml += '<div class="section-title">ğŸ”¢ å…«ä¸‡å››åƒä¿®æ³•</div>';
                    
                    // å…«ä¸‡å››åƒä¿®æ³•
                    if (data.eighty_four_thousand_methods) {
                        Object.entries(data.eighty_four_thousand_methods).forEach(([key, value]) => {
                            if (typeof value === 'object') {
                                resultHtml += `<div class="section-title">${key}</div>`;
                                resultHtml += '<div class="section-content">';
                                Object.entries(value).forEach(([subKey, subValue]) => {
                                    resultHtml += `<strong>${subKey}ï¼š</strong>${subValue}<br>`;
                                });
                                resultHtml += '</div>';
                            } else {
                                resultHtml += `<div class="section-content"><strong>${key}ï¼š</strong>${value}</div>`;
                            }
                        });
                    }
                    
                    // æ³•æ´¾æ™ºæ…§æœ¬è´¨
                    if (data.dharma_wisdom) {
                        resultHtml += '<div class="section-title">ğŸ’ æ³•æ´¾æ™ºæ…§æœ¬è´¨</div>';
                        resultHtml += '<div class="section-content">';
                        Object.entries(data.dharma_wisdom).forEach(([key, value]) => {
                            resultHtml += `<strong>${key}ï¼š</strong>${value}<br>`;
                        });
                        resultHtml += '</div>';
                    }
                    
                    resultHtml += '</div>';
                    displayResult('ğŸ”¢ å…«ä¸‡å››åƒä¿®æ³•', resultHtml);
                } else {
                    displayError(data.message || 'è·å–ä¿¡æ¯å¤±è´¥');
                }
            } catch (error) {
                displayError('ç½‘ç»œè¿æ¥å¤±è´¥ï¼š' + error.message);
            } finally {
                hideLoading();
            }
        }

        // å®Œæ•´ç†è®ºä½“ç³»
        async function showCompleteTheory() {
            hideAllPanels();
            showLoading();
            
            try {
                const response = await fetch('/api/dharma-school/complete-theory');
                const data = await response.json();
                
                if (data.status === 'success') {
                    let resultHtml = '<div class="result-section">';
                    resultHtml += '<div class="section-title">ğŸ“– æ³•æ´¾å¯†å®Œæ•´ç†è®ºä½“ç³»</div>';
                    
                    // æ ¸å¿ƒç†è®º
                    if (data.theory.æ³•æ´¾å¯†æ ¸å¿ƒç†è®º) {
                        resultHtml += '<div class="section-title">ğŸ¯ æ ¸å¿ƒç†è®º</div>';
                        resultHtml += '<div class="section-content">';
                        Object.entries(data.theory.æ³•æ´¾å¯†æ ¸å¿ƒç†è®º).forEach(([key, value]) => {
                            resultHtml += `<strong>${key}ï¼š</strong>${value}<br>`;
                        });
                        resultHtml += '</div>';
                    }
                    
                    // æ³•æ´¾å½¢æˆåŸç†
                    if (data.theory.æ³•æ´¾å½¢æˆåŸç†) {
                        resultHtml += '<div class="section-title">ğŸŒ± æ³•æ´¾å½¢æˆåŸç†</div>';
                        resultHtml += '<div class="section-content">';
                        Object.entries(data.theory.æ³•æ´¾å½¢æˆåŸç†).forEach(([key, value]) => {
                            resultHtml += `<strong>${key}ï¼š</strong>${value}<br>`;
                        });
                        resultHtml += '</div>';
                    }
                    
                    // ä¿®è¡Œè¦ç‚¹
                    if (data.theory.ä¿®è¡Œè¦ç‚¹) {
                        resultHtml += '<div class="section-title">â­ ä¿®è¡Œè¦ç‚¹</div>';
                        resultHtml += '<div class="section-content">';
                        Object.entries(data.theory.ä¿®è¡Œè¦ç‚¹).forEach(([key, value]) => {
                            resultHtml += `<strong>${key}ï¼š</strong>${value}<br>`;
                        });
                        resultHtml += '</div>';
                    }
                    
                    resultHtml += '</div>';
                    displayResult('ğŸ“– å®Œæ•´ç†è®ºä½“ç³»', resultHtml);
                } else {
                    displayError(data.message || 'è·å–ç†è®ºå¤±è´¥');
                }
            } catch (error) {
                displayError('ç½‘ç»œè¿æ¥å¤±è´¥ï¼š' + error.message);
            } finally {
                hideLoading();
            }
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            createWisdomParticles();
            
            // æ›´æ–°åè®®çŠ¶æ€
            setTimeout(() => {
                document.getElementById('protocolContent').textContent = 
`=== æ³•æ´¾å¯†ç³»ç»Ÿåè®® ===
çŠ¶æ€ï¼šå·²æ¿€æ´» âœ…
æ³•æ´¾æ•°æ®åº“ï¼šå…«ä¸‡å››åƒä¿®æ³•
æ™ºæ…§æ¥æºï¼šä½›æ™ºè€…æ•™è¯²
ä¿®è¡ŒåŸåˆ™ï¼šä»¥æ¸´æ±‚ä¹‹æ€ä¿®ä¹ 
æœ€ç»ˆç›®æ ‡ï¼šæ–­æ¬²è„±äººæ±‚é“

åè®®è¦ç‚¹ï¼š
1. æ³•æ´¾å½¢æˆè‡ªç„¶ï¼Œæ™ºæ…§æ— ç©·
2. æ ¹æ®æ ¹æ€§é€‰æ‹©é€‚åˆæ³•æ´¾
3. ä¸“ä¸€ä¿®ä¹ ï¼Œä¸å¯æœä¸‰æš®å››
4. æ­£æ³•ä¿®ä¹ ï¼Œé¿å…æ­ªé“
5. è€å¿ƒç§¯å ï¼Œè‡ªç„¶åœ†æ»¡

ğŸŒŸ æ³•æ´¾å¯†ç³»ç»Ÿå·²å°±ç»ªï¼Œæ„¿ä½›æ™ºå…‰æ˜æŒ‡å¼•æ‚¨çš„æ³•æ´¾é€‰æ‹©`;
            }, 2000);
        });
    </script>
</body>
</html>