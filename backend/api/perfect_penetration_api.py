from flask import Blueprint, request, jsonify
import random
import time
from datetime import datetime

# åˆ›å»ºä¿®æ³•åœ†é€šå¯†ç³»ç»Ÿè“å›¾
perfect_penetration_bp = Blueprint('perfect_penetration', __name__)

class PerfectPenetrationSystem:
    """ä¿®æ³•åœ†é€šå¯†ç³»ç»Ÿ - ç¬¬åå¯†æ³•"""
    
    def __init__(self):
        # åœ†é€šçš„æœ¬è´¨å®šä¹‰
        self.perfect_penetration_essence = {
            "åœ†é€šå®šä¹‰": "åœ†æ»¡é€šæ™“å®‡å®™çš„æ™ºæ…§",
            "éä½›ç­‰åŒ": "åœ†é€šä¸ç­‰äºæ˜¯ä½›ï¼Œå› ä¸ºä½›æœ‰å®ƒçš„å¦ä¸€ä¸ªå«ä¹‰",
            "é«˜æ™ºç”Ÿå‘½": "åœ¨æ•´ä¸ªå®‡å®™ç©ºé—´ä¸­è¿˜æœ‰è®¸å¤šé«˜æ™ºç”Ÿå‘½ä½“ï¼Œä½†ä¸æ˜¯ä½›",
            "ç¦…ååœ†é€š": "ç°åœ¨è®²ç¦…åçš„åœ†é€š",
            "ä½›æ™ºæ•™è¯²": "ä½›æ™ºè€…åœ¨æ•™è¯²äººçš„è¿‡ç¨‹ä¸­ï¼Œé™¤äº†ä½›é“ä¹‹ç†å¤–ï¼Œä¸»è¦æ˜¯ç¦…æ³•çš„åœ†é€š"
        }
        
        # åœ†é€šçš„è·å¾—æ–¹å¼
        self.penetration_methods = {
            "å¼Ÿå­ä¿®æ³•": "ä½›æ™ºè€…çš„å¼Ÿå­å„æœ‰å„çš„ä¿®ç¦…æ–¹æ³•å¾—ä»¥åœ†é€š",
            "äººä½“å®‡å®™": "å…¨æ˜¯ä»¥äººä½“å’Œå®‡å®™ä¸­çš„ç‰©æ€§ä½œä¸ºä¿®æŒè€…çš„å¯¹è±¡",
            "æ„Ÿè§‰å™¨å®˜": "æ˜¯ä»¥äººçš„æ„Ÿè§‰å™¨å®˜ä½œç”¨æ¥ä¿®æŒçš„",
            "ç‰©è´¨ç°è±¡": "åˆä»¥å®‡å®™é—´çš„åœ°ã€ç«ã€æ°´ã€é£ã€ç©ºç­‰ç‰©è´¨ç°è±¡ä½œä¸ºä¿®æŒçš„å› ç´ ",
            "æ‰“é€šå¤§é—¨": "ä¸»è¦æ˜¯ä¸ºäº†æ‰“é€šäº†è§£å®‡å®™çš„å¤§é—¨",
            "ç§‘å­¦è”ç³»": "è¿™ä¸€æ³•å°±æ˜¯äººä½“ä¸å®‡å®™çš„ç§‘å­¦è”ç³»"
        }
        
        # å¤©äººåˆä¸€ç³»ç»Ÿ
        self.heaven_human_unity = {
            "ä¸»è¦æ³•ç›¸": "å°±æ˜¯å¤©äººåˆä¸€çš„ä¸»è¦æ³•ç›¸",
            "äººä½“å®‡å®™å­¦": "è¿™å°±æ˜¯äººä½“å®‡å®™å­¦çš„æœ€é¡¶ï¼ˆé«˜ï¼‰å±‚æ¬¡",
            "å­¦é—®åŸºç¡€": "ä¸€åˆ‡å­¦é—®éƒ½è„±ç¦»ä¸äº†å¤©äººåˆä¸€",
            "æœ€é«˜æ³•": "è¿™æ˜¯æœ€é«˜æ³•ã€æœ€é«˜èƒ½ã€æœ€æ·±å…¥çš„æ¢ç´¢ã€æœ€ç»ˆçš„å¥¥ç§˜",
            "ä½›æ™ºåˆ¶å®š": "ä½›æ™ºè€…è§åˆ°è¿™äº›å°±åˆ¶å®šäº†è®¸å¤šæ–¹æ³•ï¼Œæ¥è¾¾åˆ°å¤©äººåˆä¸€"
        }
        
        # äºŒåäº”åœ†é€šç³»ç»Ÿ
        self.twenty_five_penetrations = {
            "æ³•ä¸­ä¹‹æ³•": "å…¶ä¸­äºŒåäº”åœ†é€šå°±æ˜¯æ³•ä¸­ä¹‹æ³•ï¼Œç¦…ä¸­ä¹‹ç¦…",
            "ä¿®ä¹ å†…å®¹": "ç”±äººçš„å…­æ ¹ã€å…­å°˜ã€å…­è¯†å’Œä¸ƒå¤§å»ä¿®ä¹ è€Œè·å¾—ä½›æ™º",
            "ç°è±¡æè¿°": "ä½†äºŒåäº”åœ†èåªè®²äº†ç°è±¡ï¼Œå‘Šè¯‰åœ¨ä»€ä¹ˆåœ°æ–¹å…¥æ‰‹å»ä¿®",
            "å®ä¿®ç¼ºå¤±": "å®ä¿®ä¹‹æ³•ä¸€ç‚¹æ²¡éœ²ï¼Œæ ¹æœ¬æ‰¾ä¸åˆ°ä¿®æ³•çš„æ·å¾„",
            "å«ç³Šè¯´æ˜": "å„ç§ä¿®æ³•ä¹‹å¯†ä½›æ™ºæ‰€æœ‰çš„ç»ä¹¦ä¸­éƒ½åªæ˜¯å«ç³Šçš„è¯´æ˜",
            "å…³é”®æœªéœ²": "è€Œå…³é”®çš„ä¸œè¥¿ä¸€ç‚¹æ²¡éœ²",
            "ä¿®æŒå›°éš¾": "è¿™ç»™åè€…çš„ä¿®æŒå¸¦æ¥å¾ˆå¤§çš„å›°éš¾",
            "æˆå°±ç¨€å°‘": "æ‰€ä»¥æˆæ­£è§‰è€…æ˜¯æå°‘çš„"
        }
        
        # å…­æ ¹åœ†é€š
        self.six_roots = {
            "çœ¼æ ¹åœ†é€š": {
                "å™¨å®˜": "çœ¼",
                "åŠŸèƒ½": "è§æ€§åœ†é€š",
                "ä¿®æ³•": "è§‚ç…§çœ¼æ ¹è§æ€§ï¼Œä¸è‘—è‰²ç›¸",
                "å¢ƒç•Œ": "è§è€Œæ— è§ï¼Œæ— è§è€Œè§"
            },
            "è€³æ ¹åœ†é€š": {
                "å™¨å®˜": "è€³",
                "åŠŸèƒ½": "é—»æ€§åœ†é€š",
                "ä¿®æ³•": "åé—»é—»è‡ªæ€§ï¼Œä¸éšå£°è½¬",
                "å¢ƒç•Œ": "é—»è€Œæ— é—»ï¼Œæ— é—»è€Œé—»"
            },
            "é¼»æ ¹åœ†é€š": {
                "å™¨å®˜": "é¼»",
                "åŠŸèƒ½": "å—…æ€§åœ†é€š",
                "ä¿®æ³•": "è§‚ç…§é¼»æ ¹å—…æ€§ï¼Œä¸è‘—é¦™è‡­",
                "å¢ƒç•Œ": "å—…è€Œæ— å—…ï¼Œæ— å—…è€Œå—…"
            },
            "èˆŒæ ¹åœ†é€š": {
                "å™¨å®˜": "èˆŒ",
                "åŠŸèƒ½": "å°æ€§åœ†é€š",
                "ä¿®æ³•": "è§‚ç…§èˆŒæ ¹å°æ€§ï¼Œä¸è‘—å‘³è§‰",
                "å¢ƒç•Œ": "å°è€Œæ— å°ï¼Œæ— å°è€Œå°"
            },
            "èº«æ ¹åœ†é€š": {
                "å™¨å®˜": "èº«",
                "åŠŸèƒ½": "è§¦æ€§åœ†é€š",
                "ä¿®æ³•": "è§‚ç…§èº«æ ¹è§¦æ€§ï¼Œä¸è‘—è§¦å—",
                "å¢ƒç•Œ": "è§¦è€Œæ— è§¦ï¼Œæ— è§¦è€Œè§¦"
            },
            "æ„æ ¹åœ†é€š": {
                "å™¨å®˜": "æ„",
                "åŠŸèƒ½": "çŸ¥æ€§åœ†é€š",
                "ä¿®æ³•": "è§‚ç…§æ„æ ¹çŸ¥æ€§ï¼Œä¸è‘—æ³•å°˜",
                "å¢ƒç•Œ": "çŸ¥è€Œæ— çŸ¥ï¼Œæ— çŸ¥è€ŒçŸ¥"
            }
        }
        
        # å…­å°˜åœ†é€šï¼ˆè¯¦ç»†ä¿®æ³•ï¼‰
        self.six_dusts = {
            "å£°å°˜åœ†é€š": {
                "ä¿®æ³•": "è§‚å£°ä¸è‚‹ï¼ŒéŸ³å‡ºäºå¿ƒä¸‹ï¼Œè§‰äºè€³é—»",
                "è¦ç‚¹": "è§‚ç…§å£°éŸ³çš„ç”Ÿèµ·å’Œæ¶ˆå¤±",
                "å¢ƒç•Œ": "å£°å°˜ä¸æŸ“ï¼Œé—»æ€§æ¸…å‡€"
            },
            "è‰²å°˜åœ†é€š": {
                "ä¿®æ³•": "è§‚è‰²ä¸æŠ¤ä¸­ï¼Œä¸€ç‰‡å•è‰²å…‰ï¼Œè§‰äºçœ¼å‰",
                "è¦ç‚¹": "è§‚ç…§è‰²ç›¸çš„è™šå¹»æœ¬è´¨",
                "å¢ƒç•Œ": "è‰²å°˜ä¸æŸ“ï¼Œè§æ€§æ¸…å‡€"
            },
            "é¦™å°˜åœ†é€š": {
                "ä¿®æ³•": "è§‚æ°”äºé¼»ä¸­ï¼Œå‡ºå…¥ä¸æ¯å¦‚ç™½é›¾ï¼Œè§‰äºé¼»è…”è½»é¡º",
                "è¦ç‚¹": "è§‚ç…§é¦™æ°”çš„æ¥å»æ— å¸¸",
                "å¢ƒç•Œ": "é¦™å°˜ä¸æŸ“ï¼Œå—…æ€§æ¸…å‡€"
            },
            "å‘³å°˜åœ†é€š": {
                "ä¿®æ³•": "è§‚æ¶²äºå£è…”ï¼Œæ´¥æ´¥ä¸æ­¢ï¼Œç™¾å‘³è§‰äºèˆŒæ„Ÿ",
                "è¦ç‚¹": "è§‚ç…§å‘³è§‰çš„ç”Ÿç­å˜åŒ–",
                "å¢ƒç•Œ": "å‘³å°˜ä¸æŸ“ï¼Œå°æ€§æ¸…å‡€"
            },
            "è§¦å°˜åœ†é€š": {
                "ä¿®æ³•": "è§‚èº«å…‰äºä½“ï¼Œè½»é£˜å¦‚çµ®ï¼Œè§‰èº«çƒ­å‡‰",
                "è¦ç‚¹": "è§‚ç…§è§¦è§‰çš„å†·çƒ­å˜åŒ–",
                "å¢ƒç•Œ": "è§¦å°˜ä¸æŸ“ï¼Œè§¦æ€§æ¸…å‡€"
            },
            "æ³•å°˜åœ†é€š": {
                "ä¿®æ³•": "è§‚èƒ¸è…”æ°”æ­¢ï¼Œå¿ƒç©ºæ„æ¶ˆï¼Œè§‰å†…è…‘å…‰æ˜",
                "è¦ç‚¹": "è§‚ç…§å¿µå¤´çš„èµ·ç­æ— å¸¸",
                "å¢ƒç•Œ": "æ³•å°˜ä¸æŸ“ï¼Œæ„æ€§æ¸…å‡€"
            }
        }
        
        # å…­è¯†åœ†é€š
        self.six_consciousnesses = {
            "çœ¼è¯†åœ†é€š": {
                "åŠŸèƒ½": "è§è¯†åœ†é€š",
                "ä¿®æ³•": "è§‚ç…§çœ¼è¯†åˆ†åˆ«ï¼Œä¸éšå¢ƒè½¬",
                "å¢ƒç•Œ": "è¯†è€Œæ— è¯†ï¼Œäº†äº†åˆ†æ˜"
            },
            "è€³è¯†åœ†é€š": {
                "åŠŸèƒ½": "é—»è¯†åœ†é€š",
                "ä¿®æ³•": "è§‚ç…§è€³è¯†åˆ†åˆ«ï¼Œä¸éšå£°è½¬",
                "å¢ƒç•Œ": "è¯†è€Œæ— è¯†ï¼Œäº†äº†åˆ†æ˜"
            },
            "é¼»è¯†åœ†é€š": {
                "åŠŸèƒ½": "å—…è¯†åœ†é€š",
                "ä¿®æ³•": "è§‚ç…§é¼»è¯†åˆ†åˆ«ï¼Œä¸éšé¦™è½¬",
                "å¢ƒç•Œ": "è¯†è€Œæ— è¯†ï¼Œäº†äº†åˆ†æ˜"
            },
            "èˆŒè¯†åœ†é€š": {
                "åŠŸèƒ½": "å°è¯†åœ†é€š",
                "ä¿®æ³•": "è§‚ç…§èˆŒè¯†åˆ†åˆ«ï¼Œä¸éšå‘³è½¬",
                "å¢ƒç•Œ": "è¯†è€Œæ— è¯†ï¼Œäº†äº†åˆ†æ˜"
            },
            "èº«è¯†åœ†é€š": {
                "åŠŸèƒ½": "è§¦è¯†åœ†é€š",
                "ä¿®æ³•": "è§‚ç…§èº«è¯†åˆ†åˆ«ï¼Œä¸éšè§¦è½¬",
                "å¢ƒç•Œ": "è¯†è€Œæ— è¯†ï¼Œäº†äº†åˆ†æ˜"
            },
            "æ„è¯†åœ†é€š": {
                "åŠŸèƒ½": "æ³•è¯†åœ†é€š",
                "ä¿®æ³•": "è§‚ç…§æ„è¯†åˆ†åˆ«ï¼Œä¸éšæ³•è½¬",
                "å¢ƒç•Œ": "è¯†è€Œæ— è¯†ï¼Œäº†äº†åˆ†æ˜"
            }
        }
        
        # ä¸ƒå¤§åœ†é€š
        self.seven_elements = {
            "åœ°å¤§åœ†é€š": {
                "æ€§è´¨": "åšå›ºæ€§",
                "ä¿®æ³•": "è§‚ç…§åœ°å¤§çš„åšå›ºæœ¬æ€§",
                "å¢ƒç•Œ": "åœ°å¤§åœ†èï¼Œæ€§ç›¸ä¸äºŒ"
            },
            "ç«å¤§åœ†é€š": {
                "æ€§è´¨": "æ¸©çƒ­æ€§",
                "ä¿®æ³•": "è§‚ç…§ç«å¤§çš„æ¸©çƒ­æœ¬æ€§",
                "å¢ƒç•Œ": "ç«å¤§åœ†èï¼Œæ€§ç›¸ä¸äºŒ"
            },
            "æ°´å¤§åœ†é€š": {
                "æ€§è´¨": "æ¹¿æ¶¦æ€§",
                "ä¿®æ³•": "è§‚ç…§æ°´å¤§çš„æ¹¿æ¶¦æœ¬æ€§",
                "å¢ƒç•Œ": "æ°´å¤§åœ†èï¼Œæ€§ç›¸ä¸äºŒ"
            },
            "é£å¤§åœ†é€š": {
                "æ€§è´¨": "åŠ¨è½¬æ€§",
                "ä¿®æ³•": "è§‚ç…§é£å¤§çš„åŠ¨è½¬æœ¬æ€§",
                "å¢ƒç•Œ": "é£å¤§åœ†èï¼Œæ€§ç›¸ä¸äºŒ"
            },
            "ç©ºå¤§åœ†é€š": {
                "æ€§è´¨": "æ— ç¢æ€§",
                "ä¿®æ³•": "è§‚ç…§ç©ºå¤§çš„æ— ç¢æœ¬æ€§",
                "å¢ƒç•Œ": "ç©ºå¤§åœ†èï¼Œæ€§ç›¸ä¸äºŒ"
            },
            "æ ¹å¤§åœ†é€š": {
                "æ€§è´¨": "è§‰çŸ¥æ€§",
                "ä¿®æ³•": "è§‚ç…§æ ¹å¤§çš„è§‰çŸ¥æœ¬æ€§",
                "å¢ƒç•Œ": "æ ¹å¤§åœ†èï¼Œæ€§ç›¸ä¸äºŒ"
            },
            "è¯†å¤§åœ†é€š": {
                "æ€§è´¨": "äº†åˆ«æ€§",
                "ä¿®æ³•": "è§‚ç…§è¯†å¤§çš„äº†åˆ«æœ¬æ€§",
                "å¢ƒç•Œ": "è¯†å¤§åœ†èï¼Œæ€§ç›¸ä¸äºŒ"
            }
        }
        
        # åœ†é€šçš„å…³é”®å¯†æ³•
        self.penetration_secrets = {
            "å†…ç…§å…³é”®": "éƒ½æ˜¯ç¦»ä¸äº†å†…ç…§ï¼Œæ˜¯å†…å…‰çš„ä½œç”¨",
            "è§‚ç…§è‡ªæ€§": "å°±æ˜¯ä»¥è§‚ç…§å†…å¿ƒçš„è‡ªæ€§è€Œæ‚Ÿå¾—",
            "å€Ÿå¤–ç¼˜å› ": "ä½†å¿…é¡»å€Ÿå¤–ç¼˜å¤–å› ",
            "å†…å¤–å› ç†": "è¿™ä¸ªé—®é¢˜æˆ‘ä»¬æ˜Ÿä½“çš„æ¯›æ³½ä¸œåœ¨çŸ›ç›¾è®ºä¸­é˜è¿°çš„å†…å¤–å› ä¸€æ ·",
            "å¤–å› æ¡ä»¶": "å¤–å› æ˜¯æ¡ä»¶ï¼Œå†…å› æ˜¯ä¾æ®",
            "ç…§å½»å†…å¿ƒ": "å¿…é¡»ç…§å½»å†…å¿ƒï¼Œè¿™å°±æ˜¯åœ†é€šçš„å…³é”®ä¹‹å¤„",
            "ä¸€åˆ‡åœ†é€šä¹‹å¯†": "è¿™ä¸€å¯†æ˜¯ä¸€åˆ‡åœ†é€šä¹‹å¯†"
        }
        
        # å†…è§‚ä¿®æ³•
        self.inner_observation = {
            "å…‰ç…§å†…å¿ƒ": "å…‰ç…§å†…å¿ƒç”¨ä½•æ³•å‘¢ï¼Ÿ",
            "å„åœ†é€šå„æœ‰æ³•": "å„åœ†é€šå„æœ‰æ³•ï¼Œä½†å¿…é¡»æ˜¯å†…è§‚",
            "å†…è§‚æ–¹æ³•": "å¦‚ä½•å†…è§‚å„æ³•æ ¹æ®å„æ³•çš„å¤–å¢ƒæ¥å®šè§‚å†…ä¹‹æ³•",
            "å…­å°˜å†…è§‚": "ç°åœ¨è®²ä¸€ä¸‹äºŒåäº”åœ†é€šä¸­å…­å°˜ä¹‹å†…è§‚ä¹‹æ³•"
        }
        
        # ä½›æ™ºä¿å®ˆçš„åŸå› 
        self.buddha_wisdom_conservation = {
            "ä¿å®ˆåŸå› ": "ä¸ºä»€ä¹ˆä½›æ™ºè€…å¦‚æ­¤ä¿å®ˆï¼Œä¸å…¬å¼€åœ†èçš„ç§˜å¯†å‘¢ï¼Ÿ",
            "éå¿ƒèƒ¸ç‹­çª„": "ä¸æ˜¯ä½›çš„å¿ƒèƒ¸ç‹­çª„",
            "ä¿®è€…æœ¬æ€§": "è€Œæ˜¯ä¿®è€…çš„æœ¬æ€§é—®é¢˜",
            "æ ¹æ€§è‰¯å¥½": "å¦‚æœä¿®è€…æ ¹æ€§è‰¯å¥½å°±ä¸ç”¨ä¿®äº†",
            "è€å¿ƒä¿®ä¹ ": "è¦è€å¿ƒåœ°ä¿®ä¹ å¿ƒæ€§ï¼Œæ¸æ¸åœ°ç§¯å ï¼Œä¸€ç‚¹ä¸€æ»´åœ°è¿›æ­¥",
            "æ•°ä¸‡åŠ«ç§¯å ": "æœ‰çš„ä½›æ€§æ˜¯ç»è¿‡æ•°ä¸‡åŠ«çš„ç§¯å çš„ç¦å¾·",
            "ç°åœ¨ç§¯å ": "ç°åœ¨æˆ‘ä»¬æ¯ä¸ªä¿®è€…éƒ½åœ¨ç§¯å ï¼Œç°åœ¨ä¿®ä¹Ÿæ˜¯ä¸ºäº†ç§¯å ",
            "è‡ªç„¶åœ†æ»¡": "åœ†æ»¡çš„æ—¶å€™è‡ªç„¶åœ†æ»¡"
        }
        
        # åœ†é€šçš„å¤šæ ·æ€§
        self.penetration_diversity = {
            "éå”¯ä¸€é€”å¾„": "ä¸ä¸€å®šé€šè¿‡äºŒåäº”åœ†æ»¡è¾¾åˆ°ä½›æ™º",
            "å…¶å®ƒæ–¹æ³•": "é€šè¿‡å…¶å®ƒæ–¹æ³•ä¹Ÿèƒ½è¾¾åˆ°çš„",
            "æ³•é—¨å¹³ç­‰": "å„ç§æ³•é—¨éƒ½èƒ½è¾¾åˆ°åœ†é€š",
            "å› äººè€Œå¼‚": "æ ¹æ®ä¸ªäººæ ¹æ€§é€‰æ‹©é€‚åˆçš„æ–¹æ³•",
            "æ®Šé€”åŒå½’": "è™½ç„¶æ–¹æ³•ä¸åŒï¼Œä½†æœ€ç»ˆç›®æ ‡ç›¸åŒ"
        }
        
        # ä¿®è¡Œè¦ç‚¹
        self.practice_essentials = {
            "å†…è§‚ä¸ºä¸»": "ä»¥å†…è§‚ä¸ºä¸»è¦ä¿®è¡Œæ–¹æ³•",
            "å€Ÿå¤–ç¼˜å› ": "å¿…é¡»å€ŸåŠ©å¤–ç¼˜å¤–å› ",
            "ç…§å½»å†…å¿ƒ": "å…³é”®æ˜¯è¦ç…§å½»å†…å¿ƒ",
            "è§‚ç…§è‡ªæ€§": "è§‚ç…§å†…å¿ƒçš„è‡ªæ€§è€Œæ‚Ÿå¾—",
            "è€å¿ƒç§¯å ": "è¦è€å¿ƒåœ°ä¿®ä¹ ï¼Œä¸€ç‚¹ä¸€æ»´åœ°ç§¯å ",
            "è‡ªç„¶åœ†æ»¡": "åœ†æ»¡çš„æ—¶å€™è‡ªç„¶åœ†æ»¡"
        }
    
    def analyze_penetration_level(self, practice_experience, meditation_depth):
        """åˆ†æåœ†é€šå±‚æ¬¡"""
        analysis = {
            "ä¿®è¡Œç»éªŒ": practice_experience,
            "ç¦…å®šæ·±åº¦": meditation_depth,
            "åœ†é€šè¯„ä¼°": self._assess_penetration_level(practice_experience, meditation_depth),
            "ä¿®è¡Œå»ºè®®": self._suggest_penetration_practice(practice_experience, meditation_depth),
            "å†…è§‚æŒ‡å¯¼": self._provide_inner_observation_guidance(practice_experience),
            "åœ†é€šæ¬¡ç¬¬": self._outline_penetration_stages(practice_experience),
            "ä½›æ™ºåŠ æŒ": "ğŸŒŸ æ„¿ä½›æ™ºå…‰æ˜ç…§å½»å†…å¿ƒï¼Œæ—©æ—¥åœ†æ»¡é€šæ™“å®‡å®™æ™ºæ…§"
        }
        return analysis
    
    def _assess_penetration_level(self, experience, depth):
        """è¯„ä¼°åœ†é€šå±‚æ¬¡"""
        if "æ·±åº¦ç¦…å®š" in experience and "å†…è§‚" in depth:
            return {
                "å±‚æ¬¡": "é«˜çº§åœ†é€š",
                "ç‰¹å¾": "å·²èƒ½ç…§å½»å†…å¿ƒï¼Œè§‚ç…§è‡ªæ€§",
                "å¢ƒç•Œ": "æ¥è¿‘åœ†æ»¡é€šæ™“å®‡å®™æ™ºæ…§",
                "å»ºè®®": "ç»§ç»­æ·±å…¥ï¼Œè‡ªç„¶åœ†æ»¡"
            }
        elif "ç¦…å®šä¿®è¡Œ" in experience and "è§‚ç…§" in depth:
            return {
                "å±‚æ¬¡": "ä¸­çº§åœ†é€š",
                "ç‰¹å¾": "å·²æœ‰å†…è§‚åŸºç¡€ï¼Œéœ€è¦æ·±åŒ–",
                "å¢ƒç•Œ": "æ­£åœ¨ç§¯å ç¦å¾·æ™ºæ…§",
                "å»ºè®®": "åŠ å¼ºå†…è§‚ï¼Œå€Ÿå¤–ç¼˜å› "
            }
        else:
            return {
                "å±‚æ¬¡": "åˆçº§åœ†é€š",
                "ç‰¹å¾": "åˆšå¼€å§‹ä¿®è¡Œï¼Œéœ€è¦åŸºç¡€è®­ç»ƒ",
                "å¢ƒç•Œ": "æ­£åœ¨å»ºç«‹ä¿®è¡ŒåŸºç¡€",
                "å»ºè®®": "ä»åŸºç¡€å†…è§‚å¼€å§‹ä¿®ä¹ "
            }
    
    def _suggest_penetration_practice(self, experience, depth):
        """å»ºè®®åœ†é€šä¿®è¡Œ"""
        suggestions = {
            "åŸºç¡€ä¿®è¡Œ": "å»ºç«‹å†…è§‚åŸºç¡€ï¼Œå­¦ä¹ ç…§å½»å†…å¿ƒ",
            "é€‰æ‹©æ³•é—¨": "æ ¹æ®ä¸ªäººæ ¹æ€§é€‰æ‹©é€‚åˆçš„åœ†é€šæ³•é—¨",
            "å†…å¤–ç»“åˆ": "å†…è§‚ä¸ºä¸»ï¼Œå€ŸåŠ©å¤–ç¼˜å¤–å› ",
            "è€å¿ƒç§¯å ": "è¦è€å¿ƒä¿®ä¹ ï¼Œä¸€ç‚¹ä¸€æ»´åœ°ç§¯å ",
            "è‡ªç„¶åœ†æ»¡": "ä¸æ€¥äºæ±‚æˆï¼Œåœ†æ»¡æ—¶è‡ªç„¶åœ†æ»¡"
        }
        
        if "å…­æ ¹" in experience:
            suggestions["å…­æ ¹åœ†é€š"] = "ä¸“ä¿®å…­æ ¹åœ†é€šï¼Œè§‚ç…§æ ¹æ€§æœ¬è´¨"
        if "å…­å°˜" in experience:
            suggestions["å…­å°˜åœ†é€š"] = "ä¸“ä¿®å…­å°˜åœ†é€šï¼Œè§‚ç…§å°˜å¢ƒè™šå¹»"
        if "å…­è¯†" in experience:
            suggestions["å…­è¯†åœ†é€š"] = "ä¸“ä¿®å…­è¯†åœ†é€šï¼Œè§‚ç…§è¯†æ€§åˆ†åˆ«"
        if "ä¸ƒå¤§" in experience:
            suggestions["ä¸ƒå¤§åœ†é€š"] = "ä¸“ä¿®ä¸ƒå¤§åœ†é€šï¼Œè§‚ç…§å¤§æ€§æœ¬è´¨"
            
        return suggestions
    
    def _provide_inner_observation_guidance(self, experience):
        """æä¾›å†…è§‚æŒ‡å¯¼"""
        guidance = {
            "å†…è§‚è¦ç‚¹": "ä»¥è§‚ç…§å†…å¿ƒçš„è‡ªæ€§è€Œæ‚Ÿå¾—",
            "å†…å…‰ä½œç”¨": "éƒ½æ˜¯ç¦»ä¸äº†å†…ç…§ï¼Œæ˜¯å†…å…‰çš„ä½œç”¨",
            "ç…§å½»å†…å¿ƒ": "å¿…é¡»ç…§å½»å†…å¿ƒï¼Œè¿™å°±æ˜¯åœ†é€šçš„å…³é”®ä¹‹å¤„",
            "å€Ÿå¤–ç¼˜å› ": "ä½†å¿…é¡»å€Ÿå¤–ç¼˜å¤–å› ",
            "å†…å¤–å› ç†": "å¤–å› æ˜¯æ¡ä»¶ï¼Œå†…å› æ˜¯ä¾æ®"
        }
        
        if "åˆå­¦" in experience:
            guidance["åˆå­¦æŒ‡å¯¼"] = "ä»åŸºç¡€å†…è§‚å¼€å§‹ï¼Œå­¦ä¹ è§‚ç…§æ–¹æ³•"
        if "è¿›é˜¶" in experience:
            guidance["è¿›é˜¶æŒ‡å¯¼"] = "æ·±åŒ–å†…è§‚ï¼ŒåŠ å¼ºç…§å½»å†…å¿ƒçš„èƒ½åŠ›"
        if "é«˜çº§" in experience:
            guidance["é«˜çº§æŒ‡å¯¼"] = "åœ†èå†…è§‚ï¼Œè¾¾åˆ°è‡ªç„¶åœ†æ»¡"
            
        return guidance
    
    def _outline_penetration_stages(self, experience):
        """æ¦‚è¿°åœ†é€šæ¬¡ç¬¬"""
        stages = {
            "åˆçº§é˜¶æ®µ": {
                "ç›®æ ‡": "å»ºç«‹å†…è§‚åŸºç¡€",
                "ä¿®æ³•": "å­¦ä¹ åŸºç¡€è§‚ç…§æ–¹æ³•",
                "æ—¶é—´": "1-3å¹´"
            },
            "ä¸­çº§é˜¶æ®µ": {
                "ç›®æ ‡": "æ·±åŒ–å†…è§‚èƒ½åŠ›",
                "ä¿®æ³•": "ä¸“ä¿®é€‰å®šçš„åœ†é€šæ³•é—¨",
                "æ—¶é—´": "3-10å¹´"
            },
            "é«˜çº§é˜¶æ®µ": {
                "ç›®æ ‡": "åœ†æ»¡é€šæ™“å®‡å®™",
                "ä¿®æ³•": "åœ†èæ‰€æœ‰åœ†é€šæ³•é—¨",
                "æ—¶é—´": "10å¹´ä»¥ä¸Š"
            }
        }
        return stages
    
    def generate_six_dust_practice(self, selected_dust):
        """ç”Ÿæˆå…­å°˜ä¿®æ³•"""
        practice = {
            "é€‰æ‹©å°˜å¢ƒ": selected_dust,
            "ä¿®æ³•è¯¦è§£": self._explain_dust_practice(selected_dust),
            "å†…è§‚è¦ç‚¹": self._highlight_inner_observation_points(selected_dust),
            "ä¿®è¡Œæ­¥éª¤": self._outline_practice_steps(selected_dust),
            "æ³¨æ„äº‹é¡¹": self._provide_practice_warnings(selected_dust),
            "é¢„æœŸæ•ˆæœ": self._describe_expected_results(selected_dust),
            "ä½›æ™ºå¼€ç¤º": "ğŸŒŸ å…­å°˜åœ†é€šï¼Œå¯ä¿®ä¹ ï¼Œæ„¿æ‚¨æ—©æ—¥è¯å¾—å°˜å¢ƒä¸æŸ“çš„æ¸…å‡€å¢ƒç•Œ"
        }
        return practice
    
    def _explain_dust_practice(self, dust):
        """è§£é‡Šå°˜å¢ƒä¿®æ³•"""
        if dust in self.six_dusts:
            return self.six_dusts[dust]
        else:
            return {
                "ä¿®æ³•": "æ ¹æ®é€‰å®šå°˜å¢ƒè¿›è¡Œç›¸åº”çš„å†…è§‚ä¿®ä¹ ",
                "è¦ç‚¹": "è§‚ç…§å°˜å¢ƒçš„ç”Ÿç­å˜åŒ–å’Œè™šå¹»æœ¬è´¨",
                "å¢ƒç•Œ": "è¾¾åˆ°å°˜å¢ƒä¸æŸ“ï¼Œæœ¬æ€§æ¸…å‡€"
            }
    
    def _highlight_inner_observation_points(self, dust):
        """çªå‡ºå†…è§‚è¦ç‚¹"""
        return {
            "å†…ç…§å…³é”®": "éƒ½æ˜¯ç¦»ä¸äº†å†…ç…§ï¼Œæ˜¯å†…å…‰çš„ä½œç”¨",
            "è§‚ç…§è‡ªæ€§": "ä»¥è§‚ç…§å†…å¿ƒçš„è‡ªæ€§è€Œæ‚Ÿå¾—",
            "å€Ÿå¤–ç¼˜å› ": "å¿…é¡»å€Ÿå¤–ç¼˜å¤–å› ",
            "ç…§å½»å†…å¿ƒ": "å¿…é¡»ç…§å½»å†…å¿ƒï¼Œè¿™å°±æ˜¯åœ†é€šçš„å…³é”®ä¹‹å¤„",
            "å…·ä½“æ–¹æ³•": f"é’ˆå¯¹{dust}çš„å…·ä½“å†…è§‚æ–¹æ³•"
        }
    
    def _outline_practice_steps(self, dust):
        """æ¦‚è¿°ä¿®è¡Œæ­¥éª¤"""
        return {
            "ç¬¬ä¸€æ­¥": "å»ºç«‹æ­£ç¡®çš„ä¿®è¡Œå§¿åŠ¿å’Œç¯å¢ƒ",
            "ç¬¬äºŒæ­¥": "ä¸“æ³¨äºé€‰å®šçš„å°˜å¢ƒå¯¹è±¡",
            "ç¬¬ä¸‰æ­¥": "è§‚ç…§å°˜å¢ƒçš„ç”Ÿèµ·å’Œå˜åŒ–",
            "ç¬¬å››æ­¥": "æ·±å…¥å†…è§‚ï¼Œç…§å½»å†…å¿ƒ",
            "ç¬¬äº”æ­¥": "è¾¾åˆ°å°˜å¢ƒä¸æŸ“çš„å¢ƒç•Œ"
        }
    
    def _provide_practice_warnings(self, dust):
        """æä¾›ä¿®è¡Œæ³¨æ„äº‹é¡¹"""
        return [
            "ä¸å¯æ‰§ç€äºå¤–å¢ƒç°è±¡",
            "è¦ä»¥å†…è§‚ä¸ºä¸»ï¼Œå¤–å¢ƒä¸ºè¾…",
            "ä¿æŒè€å¿ƒï¼Œä¸æ€¥äºæ±‚æˆ",
            "é‡åˆ°éšœç¢æ—¶è¦åšæŒä¿®ä¹ ",
            "å®šæœŸæ£€æŸ¥ä¿®è¡Œè¿›å±•"
        ]
    
    def _describe_expected_results(self, dust):
        """æè¿°é¢„æœŸæ•ˆæœ"""
        return {
            "çŸ­æœŸæ•ˆæœ": "å¿ƒå¢ƒé€æ¸æ¸…å‡€ï¼Œä¸æ˜“è¢«å¤–å¢ƒå¹²æ‰°",
            "ä¸­æœŸæ•ˆæœ": "å†…è§‚èƒ½åŠ›å¢å¼ºï¼Œèƒ½å¤Ÿç…§å½»å†…å¿ƒ",
            "é•¿æœŸæ•ˆæœ": "è¾¾åˆ°åœ†é€šå¢ƒç•Œï¼Œåœ†æ»¡é€šæ™“å®‡å®™æ™ºæ…§",
            "æœ€ç»ˆç›®æ ‡": "è¯å¾—ä¸ç”Ÿä¸ç­çš„æœ¬æ€§"
        }
    
    def resolve_penetration_confusion(self, confusion_type):
        """è§£ç­”åœ†é€šå›°æƒ‘"""
        resolution = {
            "å›°æƒ‘ç±»å‹": confusion_type,
            "å›°æƒ‘è§£ç­”": self._provide_penetration_resolution(confusion_type),
            "ç†è®ºä¾æ®": self._explain_penetration_theory(confusion_type),
            "å®è·µæŒ‡å¯¼": self._provide_penetration_guidance(confusion_type),
            "ä½›æ™ºä¿å®ˆåŸå› ": self.buddha_wisdom_conservation,
            "ä½›æ™ºå¼€ç¤º": "ğŸŒŸ åœ†é€šä¹‹å¯†åœ¨äºå†…è§‚ï¼Œç…§å½»å†…å¿ƒå³æ˜¯å…³é”®"
        }
        return resolution
    
    def _provide_penetration_resolution(self, confusion_type):
        """æä¾›åœ†é€šå›°æƒ‘è§£ç­”"""
        resolutions = {
            "ä¿®æ³•éš¾æ‡‚": {
                "é—®é¢˜": "ä¸ºä»€ä¹ˆåœ†é€šä¿®æ³•å¦‚æ­¤éš¾æ‡‚ï¼Ÿ",
                "è§£ç­”": "ä½›æ™ºè€…åªè®²ç°è±¡ï¼Œå®ä¿®ä¹‹æ³•ä¸€ç‚¹æ²¡éœ²",
                "åŸå› ": "ä¸æ˜¯ä½›çš„å¿ƒèƒ¸ç‹­çª„ï¼Œè€Œæ˜¯ä¿®è€…çš„æœ¬æ€§é—®é¢˜"
            },
            "æˆå°±ç¨€å°‘": {
                "é—®é¢˜": "ä¸ºä»€ä¹ˆæˆæ­£è§‰è€…æå°‘ï¼Ÿ",
                "è§£ç­”": "å…³é”®çš„ä¸œè¥¿ä¸€ç‚¹æ²¡éœ²ï¼Œç»™ä¿®æŒå¸¦æ¥å¾ˆå¤§å›°éš¾",
                "åŸå› ": "éœ€è¦æ•°ä¸‡åŠ«çš„ç§¯å ç¦å¾·"
            },
            "å†…è§‚å›°éš¾": {
                "é—®é¢˜": "å¦‚ä½•è¿›è¡Œæœ‰æ•ˆçš„å†…è§‚ï¼Ÿ",
                "è§£ç­”": "å¿…é¡»ç…§å½»å†…å¿ƒï¼Œè¿™å°±æ˜¯åœ†é€šçš„å…³é”®ä¹‹å¤„",
                "æ–¹æ³•": "ä»¥è§‚ç…§å†…å¿ƒçš„è‡ªæ€§è€Œæ‚Ÿå¾—ï¼Œä½†å¿…é¡»å€Ÿå¤–ç¼˜å¤–å› "
            }
        }
        return resolutions.get(confusion_type, {"è§£ç­”": "éœ€è¦å…·ä½“åˆ†æçš„åœ†é€šé—®é¢˜"})
    
    def _explain_penetration_theory(self, confusion_type):
        """è§£é‡Šåœ†é€šç†è®º"""
        return {
            "åœ†é€šæœ¬è´¨": "åœ†æ»¡é€šæ™“å®‡å®™çš„æ™ºæ…§",
            "ä¿®è¡Œæ–¹æ³•": "ä»¥äººä½“å’Œå®‡å®™ä¸­çš„ç‰©æ€§ä½œä¸ºä¿®æŒå¯¹è±¡",
            "å¤©äººåˆä¸€": "äººä½“ä¸å®‡å®™çš„ç§‘å­¦è”ç³»",
            "å†…è§‚å…³é”®": "éƒ½æ˜¯ç¦»ä¸äº†å†…ç…§ï¼Œæ˜¯å†…å…‰çš„ä½œç”¨",
            "è‡ªç„¶åœ†æ»¡": "åœ†æ»¡çš„æ—¶å€™è‡ªç„¶åœ†æ»¡"
        }
    
    def _provide_penetration_guidance(self, confusion_type):
        """æä¾›åœ†é€šå®è·µæŒ‡å¯¼"""
        return {
            "ä¿®è¡Œæ€åº¦": "è¦è€å¿ƒåœ°ä¿®ä¹ å¿ƒæ€§ï¼Œæ¸æ¸åœ°ç§¯å ",
            "ä¿®è¡Œæ–¹æ³•": "ä»¥å†…è§‚ä¸ºä¸»ï¼Œå€ŸåŠ©å¤–ç¼˜å¤–å› ",
            "ä¿®è¡Œç›®æ ‡": "ç…§å½»å†…å¿ƒï¼Œè§‚ç…§è‡ªæ€§",
            "ä¿®è¡Œè¿‡ç¨‹": "ä¸€ç‚¹ä¸€æ»´åœ°è¿›æ­¥ï¼Œä¸æ€¥äºæ±‚æˆ",
            "ä¿®è¡Œç»“æœ": "è‡ªç„¶åœ†æ»¡ï¼Œé€šæ™“å®‡å®™æ™ºæ…§"
        }
    
    def get_complete_theory(self):
        """è·å–ä¿®æ³•åœ†é€šå¯†å®Œæ•´ç†è®º"""
        theory = {
            "ä¿®æ³•åœ†é€šå¯†æ ¸å¿ƒç†è®º": {
                "åœ†é€šå®šä¹‰": "åœ†æ»¡é€šæ™“å®‡å®™çš„æ™ºæ…§",
                "ä¿®è¡Œæ–¹æ³•": "ä»¥äººä½“å’Œå®‡å®™ä¸­çš„ç‰©æ€§ä½œä¸ºä¿®æŒå¯¹è±¡",
                "å¤©äººåˆä¸€": "äººä½“ä¸å®‡å®™çš„ç§‘å­¦è”ç³»",
                "å†…è§‚å…³é”®": "éƒ½æ˜¯ç¦»ä¸äº†å†…ç…§ï¼Œæ˜¯å†…å…‰çš„ä½œç”¨"
            },
            "åœ†é€šæœ¬è´¨å®šä¹‰": self.perfect_penetration_essence,
            "åœ†é€šè·å¾—æ–¹å¼": self.penetration_methods,
            "å¤©äººåˆä¸€ç³»ç»Ÿ": self.heaven_human_unity,
            "äºŒåäº”åœ†é€šç³»ç»Ÿ": self.twenty_five_penetrations,
            "å…­æ ¹åœ†é€š": self.six_roots,
            "å…­å°˜åœ†é€š": self.six_dusts,
            "å…­è¯†åœ†é€š": self.six_consciousnesses,
            "ä¸ƒå¤§åœ†é€š": self.seven_elements,
            "åœ†é€šå…³é”®å¯†æ³•": self.penetration_secrets,
            "å†…è§‚ä¿®æ³•": self.inner_observation,
            "ä½›æ™ºä¿å®ˆåŸå› ": self.buddha_wisdom_conservation,
            "åœ†é€šå¤šæ ·æ€§": self.penetration_diversity,
            "ä¿®è¡Œè¦ç‚¹": self.practice_essentials,
            "ä¿®è¡Œæ€»ç»“": {
                "æ ¸å¿ƒè¦ç‚¹": "ç…§å½»å†…å¿ƒï¼Œè§‚ç…§è‡ªæ€§",
                "ä¿®è¡Œæ–¹æ³•": "å†…è§‚ä¸ºä¸»ï¼Œå€Ÿå¤–ç¼˜å› ",
                "ä¿®è¡Œæ€åº¦": "è€å¿ƒç§¯å ï¼Œè‡ªç„¶åœ†æ»¡",
                "æœ€ç»ˆç›®æ ‡": "åœ†æ»¡é€šæ™“å®‡å®™æ™ºæ…§"
            }
        }
        return theory

# åˆ›å»ºä¿®æ³•åœ†é€šå¯†ç³»ç»Ÿå®ä¾‹
perfect_penetration_system = PerfectPenetrationSystem()

@perfect_penetration_bp.route('/penetration-analysis', methods=['POST'])
def penetration_analysis():
    """åœ†é€šå±‚æ¬¡åˆ†æ"""
    try:
        data = request.get_json()
        practice_experience = data.get('practice_experience', '')
        meditation_depth = data.get('meditation_depth', '')
        
        analysis = perfect_penetration_system.analyze_penetration_level(practice_experience, meditation_depth)
        
        return jsonify({
            "status": "success",
            "analysis": analysis,
            "timestamp": datetime.now().isoformat()
        })
    except Exception as e:
        return jsonify({"status": "error", "message": str(e)}), 500

@perfect_penetration_bp.route('/six-dust-practice', methods=['POST'])
def six_dust_practice():
    """å…­å°˜ä¿®æ³•ç”Ÿæˆ"""
    try:
        data = request.get_json()
        selected_dust = data.get('selected_dust', 'å£°å°˜åœ†é€š')
        
        practice = perfect_penetration_system.generate_six_dust_practice(selected_dust)
        
        return jsonify({
            "status": "success",
            "practice": practice,
            "timestamp": datetime.now().isoformat()
        })
    except Exception as e:
        return jsonify({"status": "error", "message": str(e)}), 500

@perfect_penetration_bp.route('/penetration-confusion', methods=['POST'])
def penetration_confusion():
    """åœ†é€šå›°æƒ‘è§£ç­”"""
    try:
        data = request.get_json()
        confusion_type = data.get('confusion_type', 'ä¿®æ³•éš¾æ‡‚')
        
        resolution = perfect_penetration_system.resolve_penetration_confusion(confusion_type)
        
        return jsonify({
            "status": "success",
            "resolution": resolution,
            "timestamp": datetime.now().isoformat()
        })
    except Exception as e:
        return jsonify({"status": "error", "message": str(e)}), 500

@perfect_penetration_bp.route('/twenty-five-penetrations', methods=['GET'])
def get_twenty_five_penetrations():
    """è·å–äºŒåäº”åœ†é€š"""
    try:
        return jsonify({
            "status": "success",
            "six_roots": perfect_penetration_system.six_roots,
            "six_dusts": perfect_penetration_system.six_dusts,
            "six_consciousnesses": perfect_penetration_system.six_consciousnesses,
            "seven_elements": perfect_penetration_system.seven_elements,
            "penetration_secrets": perfect_penetration_system.penetration_secrets,
            "timestamp": datetime.now().isoformat()
        })
    except Exception as e:
        return jsonify({"status": "error", "message": str(e)}), 500

@perfect_penetration_bp.route('/complete-theory', methods=['GET'])
def get_complete_theory():
    """è·å–ä¿®æ³•åœ†é€šå¯†å®Œæ•´ç†è®º"""
    try:
        theory = perfect_penetration_system.get_complete_theory()
        
        return jsonify({
            "status": "success",
            "theory": theory,
            "timestamp": datetime.now().isoformat()
        })
    except Exception as e:
        return jsonify({"status": "error", "message": str(e)}), 500

@perfect_penetration_bp.route('/inner-observation', methods=['GET'])
def get_inner_observation():
    """è·å–å†…è§‚ä¿®æ³•"""
    try:
        return jsonify({
            "status": "success",
            "inner_observation": perfect_penetration_system.inner_observation,
            "penetration_secrets": perfect_penetration_system.penetration_secrets,
            "practice_essentials": perfect_penetration_system.practice_essentials,
            "buddha_wisdom_conservation": perfect_penetration_system.buddha_wisdom_conservation,
            "timestamp": datetime.now().isoformat()
        })
    except Exception as e:
        return jsonify({"status": "error", "message": str(e)}), 500