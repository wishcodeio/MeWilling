from flask import Blueprint, request, jsonify
import random
import time
from datetime import datetime

# åˆ›å»ºè¥¿æ–¹æä¹ä¸–ç•Œå¯†ç³»ç»Ÿè“å›¾
pure_land_bp = Blueprint('pure_land', __name__)

class PureLandSystem:
    """è¥¿æ–¹æä¹ä¸–ç•Œå¯†ç³»ç»Ÿ - ç¬¬ä¸ƒå¯†æ³•"""
    
    def __init__(self):
        # è¥¿æ–¹æä¹ä¸–ç•ŒåŸºæœ¬ä¿¡æ¯
        self.pure_land_info = {
            "ä½ç½®": "è·ç¦»é“¶æ²³ç³»ä¸€äº¿å…‰å¹´",
            "å¤§å°": "çº¦ä¸ºåœ°çƒçš„7500å€",
            "ç‰¹æ€§": "è‡ªè½¬ä¸å…¬è½¬ï¼Œè‡ªèº«å‘å…‰ä¸å¸¦çƒ­è¾å°„",
            "å¤–è§‚": "ä»è¿œå¤„çœ‹æäº®è·ƒçœ¼ï¼Œå†…éƒ¨å…‰é›¾é®ç›–ä¼˜é›…å£®è§‚",
            "ç”Ÿå‘½ä¾é ": "å…‰é›¾å°±æ˜¯ä½›æ™ºè€…ç”Ÿå‘½çš„ä¾é ",
            "å»ºç­‘ç‰¹è‰²": "é›†ä¸­å®‡å®™å„æ˜Ÿä½“å»ºç­‘ï¼Œæ˜¯å®‡å®™å»ºç­‘åšè§ˆä¼š",
            "ç”Ÿå‘½å½¢æ€": "é›†ä¸­å®‡å®™ä¸–ç•Œæœ€æ®Šèƒœçš„äººæ€ï¼Œç¾å¦™åŠ¨äºº"
        }
        
        # ä½›æ™ºè€…ç”Ÿå­˜ç‰¹æ€§
        self.buddha_beings_characteristics = {
            "ç”Ÿå‘½æœ¬è´¨": "æ°¸æ’çš„é«˜æ™ºèƒ½ç”Ÿå‘½ï¼Œæ°¸æ’ä¸ç­",
            "èº«ä½“ç‰¹æ€§": "èƒ½è´¨é‡é‡å¾®å¼±ï¼Œæ„ä¸æˆä½“ï¼Œåªæœ‰å½¢çŠ¶",
            "èº«å½¢æ ‡å‡†": "ä»¥å®‡å®™ä¸­æœ€ç¾çš„èº«å½¢ä½œä¸ºä»–ä»¬çš„èº«å½¢",
            "ç”Ÿå­˜æ–¹å¼": "å…‰é›¾æ˜¯ç”Ÿå‘½ä¾é ï¼Œå¦‚åœ°çƒäººå‘¼å¸ç©ºæ°”",
            "ç§»åŠ¨èƒ½åŠ›": "å¯åˆ°è¾¾ä»»ä½•ä¸–ç•Œï¼Œä»¥èº«å½¢å‡ºç°éä½“å½¢",
            "æ¬²æœ›çŠ¶æ€": "æ— æ¬²æŸ“ï¼Œå› ä¸ºæ˜¯èº«å½¢å‡ºç°è€Œéè‚‰èº«",
            "å˜åŒ–ç‰¹æ€§": "ç”Ÿå‘½ä¸å˜ï¼Œä¸äººçš„å˜æ¢å½¢æˆå¯¹æ¯”",
            "é€‚åº”èƒ½åŠ›": "åªè¦æœ‰å…‰å’Œèƒ½å°±èƒ½ç”Ÿå­˜ï¼Œæ°¸æ’ç”Ÿå‘½"
        }
        
        # æä¹ä¸å‡¡ä¹çš„åŒºåˆ«
        self.bliss_comparison = {
            "å‡¡é—´ä¹‹ä¹": {
                "æ€§è´¨": "ä¸ƒæƒ…å…­æ¬²ä¸­çš„ä¸€ç§",
                "ç‰¹å¾": "æœ‰åˆ†åˆ«çš„æ¬²ç•Œä¹‹ä¹",
                "å±€é™": "å¸¦æœ‰çº¯ç²¹çš„æ¬²ä¹ï¼Œè„±ç¦»ä¸äº†æ¬²çš„è¡Œä¸º",
                "ä¾æ‰˜": "åœ¨è‚‰ä½“ä¸Šäº§ç”Ÿ",
                "çŠ¶æ€": "æœ‰å¿§æœ‰åˆ†åˆ«"
            },
            "æä¹ä¹‹ä¹": {
                "æ€§è´¨": "åˆ°äº†æç‚¹äº§ç”Ÿæœ¬è´¨å˜åŒ–",
                "ç‰¹å¾": "æ¬²æ€§æ¶ˆé™¤çš„æ— æ¬²ä¹‹ä¹",
                "è¶…è¶Š": "ä¸åœ¨è‚‰ä½“ä¸Šï¼Œè€Œæ˜¯åœ¨å½¢æ€ä¸Š",
                "å¢ƒç•Œ": "è¶…å‡¡å…¥åœ£çš„ä¹",
                "çŠ¶æ€": "æ°¸è¿œæ— å¿§ï¼Œä¸åˆ†åˆ«çš„ä¸€ä¹"
            }
        }
        
        # åä¹ç³»ç»Ÿ
        self.ten_bliss = {
            "ç¬¬ä¸€ä¹": {"åç§°": "æ— ç”Ÿç­ä¹", "ç‰¹å¾": "æ°¸æ’ä¸å˜çš„å­˜åœ¨çŠ¶æ€"},
            "ç¬¬äºŒä¹": {"åç§°": "æ— æ¬²æŸ“ä¹", "ç‰¹å¾": "å®Œå…¨è¶…è¶Šä¸ƒæƒ…å…­æ¬²"},
            "ç¬¬ä¸‰ä¹": {"åç§°": "å…‰æ˜éç…§ä¹", "ç‰¹å¾": "å…‰é›¾ç¯ç»•çš„æ®Šèƒœå¢ƒç•Œ"},
            "ç¬¬å››ä¹": {"åç§°": "è‡ªåœ¨æ— ç¢ä¹", "ç‰¹å¾": "å¯è¾¾ä»»ä½•ä¸–ç•Œçš„è‡ªç”±"},
            "ç¬¬äº”ä¹": {"åç§°": "æ™ºæ…§åœ†æ»¡ä¹", "ç‰¹å¾": "é«˜æ™ºèƒ½ç”Ÿå‘½çš„è§‰æ‚ŸçŠ¶æ€"},
            "ç¬¬å…­ä¹": {"åç§°": "å½¢æ€ç¾å¦™ä¹", "ç‰¹å¾": "å®‡å®™æœ€ç¾èº«å½¢çš„æ˜¾ç°"},
            "ç¬¬ä¸ƒä¹": {"åç§°": "æ°¸æ’ç”Ÿå‘½ä¹", "ç‰¹å¾": "ä¸ç”Ÿä¸ç­çš„ç”Ÿå‘½çŠ¶æ€"},
            "ç¬¬å…«ä¹": {"åç§°": "æ— å¿§æ— è™‘ä¹", "ç‰¹å¾": "æ°¸è¿œæ— å¿§çš„å¿ƒå¢ƒ"},
            "ç¬¬ä¹ä¹": {"åç§°": "å®‡å®™å’Œè°ä¹", "ç‰¹å¾": "ä¸å®‡å®™å®Œå…¨å’Œè°ç»Ÿä¸€"},
            "ç¬¬åä¹": {"åç§°": "åœ†æ»¡ç©¶ç«Ÿä¹", "ç‰¹å¾": "ä¸€åˆ‡åŠŸå¾·åœ†æ»¡çš„ç»ˆæçŠ¶æ€"}
        }
        
        # å¾€ç”Ÿæ¡ä»¶ç³»ç»Ÿ
        self.rebirth_conditions = {
            "åŸºæœ¬æ¡ä»¶": {
                "ä¿¡æ„¿è¡Œ": "æ·±ä¿¡æä¹ä¸–ç•Œå­˜åœ¨ï¼Œå‘æ„¿å¾€ç”Ÿï¼Œå®è¡Œå¿µä½›",
                "æ–­æ¬²ä¿®è¡Œ": "é€æ­¥æ–­é™¤ä¸ƒæƒ…å…­æ¬²çš„æŸç¼š",
                "æ„è¯†å‡€åŒ–": "å‡€åŒ–æ„è¯†ä½“ï¼Œå‡†å¤‡ä¸è‚‰ä½“åˆ†ç¦»",
                "ä½›æ€§å¼€å‘": "å¼€å‘å†…åœ¨ä½›æ€§ï¼Œä¸ä½›æ™ºç›¸åº”"
            },
            "ä¸´ç»ˆè¦æ±‚": {
                "æ­£å¿µåˆ†æ˜": "ä¸´ç»ˆæ—¶ä¿æŒæ¸…é†’çš„æ„è¯†",
                "å¿µä½›ä¸æ–­": "æŒç»­å¿µ'é˜¿å¼¥é™€'ï¼ˆä¸åŠ ä½›å­—ï¼‰",
                "æ”¾ä¸‹æ‰§ç€": "å¯¹è‚‰ä½“å’Œä¸–é—´å®Œå…¨æ”¾ä¸‹",
                "è¿æ¥æ¥å¼•": "å‡†å¤‡æ¥å—é˜¿å¼¥é™€ä½›çš„æ¥å¼•"
            },
            "ç‰¹æ®Šè¯´æ˜": {
                "å¿µä½›æ–¹æ³•": "å¿µ'é˜¿å¼¥é™€'æ¯”å¿µ'é˜¿å¼¥é™€ä½›'æ•ˆåº”æ›´å¥½",
                "æ¥å¼•æ¡ä»¶": "ç¡¬æ¢†æ¢†çš„å‘¼å”¤ä¸ä¼šå¾—åˆ°æ¥å¼•",
                "å¿ƒå¢ƒè¦æ±‚": "å¿…é¡»æ˜¯çœŸè¯šæ³åˆ‡çš„å‘¼å”¤",
                "æ—¶æœºæŠŠæ¡": "åœ¨æ„è¯†ä½“å³å°†åˆ†ç¦»æ—¶æœ€ä¸ºå…³é”®"
            }
        }
        
        # æä¹ä¸–ç•Œå±‚æ¬¡
        self.pure_land_levels = {
            "ä¸‹å“ä¸‹ç”Ÿ": {"æ¡ä»¶": "ä¸´ç»ˆå¿µä½›ï¼Œä¸šéšœè¾ƒé‡", "ç‰¹å¾": "è²èŠ±ä¸­ä¿®è¡Œæ—¶é—´è¾ƒé•¿"},
            "ä¸‹å“ä¸­ç”Ÿ": {"æ¡ä»¶": "å¹³æ—¶å¶æœ‰å–„è¡Œï¼Œä¸´ç»ˆé‡å–„çŸ¥è¯†", "ç‰¹å¾": "è²èŠ±ä¸­ä¿®è¡Œé€æ¸ç²¾è¿›"},
            "ä¸‹å“ä¸Šç”Ÿ": {"æ¡ä»¶": "æœ‰ä¸€å®šä¿®è¡ŒåŸºç¡€ï¼Œä¸´ç»ˆæ­£å¿µ", "ç‰¹å¾": "è¾ƒå¿«å¼€èŠ±è§ä½›"},
            "ä¸­å“ä¸‹ç”Ÿ": {"æ¡ä»¶": "æŒæˆ’ä¿®å–„ï¼Œä½†æœªæ·±å…¥ç¦…å®š", "ç‰¹å¾": "è²èŠ±å“è´¨è¾ƒå¥½"},
            "ä¸­å“ä¸­ç”Ÿ": {"æ¡ä»¶": "æˆ’è¡Œæ¸…å‡€ï¼Œæœ‰ç¦…å®šåŸºç¡€", "ç‰¹å¾": "å¿«é€Ÿé€‚åº”æä¹ç¯å¢ƒ"},
            "ä¸­å“ä¸Šç”Ÿ": {"æ¡ä»¶": "æˆ’å®šæ…§ä¸‰å­¦å…·è¶³", "ç‰¹å¾": "å³æ—¶èŠ±å¼€è§ä½›"},
            "ä¸Šå“ä¸‹ç”Ÿ": {"æ¡ä»¶": "å‘è©æå¿ƒï¼Œæ·±ä¿¡å› æœ", "ç‰¹å¾": "è²èŠ±æ®Šèƒœï¼Œæ™ºæ…§æ¸å¼€"},
            "ä¸Šå“ä¸­ç”Ÿ": {"æ¡ä»¶": "è§£ç¬¬ä¸€ä¹‰ï¼Œä¸è°¤å¤§ä¹˜", "ç‰¹å¾": "èŠ±å¼€å³æ‚Ÿæ— ç”Ÿæ³•å¿"},
            "ä¸Šå“ä¸Šç”Ÿ": {"æ¡ä»¶": "æ…ˆå¿ƒä¸æ€ï¼Œå…·è¯¸æˆ’è¡Œ", "ç‰¹å¾": "å³æ—¶èŠ±å¼€ï¼Œè§ä½›é—»æ³•"}
        }
        
        # å®‡å®™æ˜Ÿä½“ä¸–ç•Œç³»ç»Ÿ
        self.cosmic_worlds = {
            "å¤§åƒä¸–ç•Œæ„æˆ": {
                "åŒ…å«èŒƒå›´": "å®‡å®™ä¸­çš„æ˜Ÿä½“ä¸–ç•Œï¼Œä¸åŒ…æ‹¬å‘çƒ­çš„æ’æ˜Ÿ",
                "ä¸»è¦ç»„æˆ": "è¡Œæ˜Ÿä¸–ç•Œå’Œä¸è¿è½¬çš„ä¸–ç•Œ",
                "æä¹ä½ç½®": "å¤§åƒä¸–ç•Œä¸­çš„ç‰¹æ®Šæ˜Ÿä½“",
                "ç§‘å­¦æ€§è´¨": "å®ä½“å­˜åœ¨ï¼Œéè™šå¹»å¢ƒç•Œ"
            },
            "å…¶ä»–å‡€åœŸ": {
                "ä¸œæ–¹å‡€åœŸ": "è¯å¸ˆä½›çš„ç‰ç’ƒä¸–ç•Œ",
                "å—æ–¹å‡€åœŸ": "å®ç”Ÿä½›çš„å…·å¾·ä¸–ç•Œ",
                "åŒ—æ–¹å‡€åœŸ": "ä¸ç©ºæˆå°±ä½›çš„èƒœä¸šä¸–ç•Œ",
                "ä¸­å¤®å‡€åœŸ": "æ¯—å¢é®é‚£ä½›çš„å¯†ä¸¥ä¸–ç•Œ"
            }
        }
    
    def analyze_rebirth_potential(self, current_practice, spiritual_state):
        """åˆ†æå¾€ç”Ÿæ½œåŠ›"""
        analysis = {
            "å½“å‰ä¿®è¡ŒçŠ¶å†µ": current_practice,
            "ç²¾ç¥çŠ¶æ€è¯„ä¼°": spiritual_state,
            "å¾€ç”Ÿç­‰çº§é¢„æµ‹": self._predict_rebirth_level(current_practice, spiritual_state),
            "éœ€è¦æ”¹è¿›çš„æ–¹é¢": self._identify_improvement_areas(current_practice, spiritual_state),
            "ä¿®è¡Œå»ºè®®": self._generate_practice_suggestions(current_practice, spiritual_state),
            "ä¸´ç»ˆå‡†å¤‡": self._create_death_preparation_plan(),
            "å®‡å®™åŠ æŒ": "ğŸŒŸ é˜¿å¼¥é™€ä½›å…‰æ˜åŠ æŒï¼Œæ„¿æ‚¨æ—©æ—¥å…·è¶³å¾€ç”Ÿæ¡ä»¶"
        }
        return analysis
    
    def _predict_rebirth_level(self, practice, state):
        """é¢„æµ‹å¾€ç”Ÿç­‰çº§"""
        if "æ·±å…¥ç¦…å®š" in practice and "æ…ˆæ‚²å¿ƒ" in state:
            return "ä¸Šå“ä¸Šç”Ÿ"
        elif "æŒæˆ’æ¸…å‡€" in practice and "æ™ºæ…§å¼€å¯" in state:
            return "ä¸Šå“ä¸­ç”Ÿ"
        elif "å¿µä½›ç²¾è¿›" in practice and "ä¿¡æ„¿åšå›º" in state:
            return "ä¸­å“ä¸Šç”Ÿ"
        elif "å¶æœ‰ä¿®è¡Œ" in practice and "å–„å¿ƒ" in state:
            return "ä¸‹å“ä¸­ç”Ÿ"
        else:
            return "éœ€è¦åŠ å¼ºä¿®è¡Œ"
    
    def _identify_improvement_areas(self, practice, state):
        """è¯†åˆ«éœ€è¦æ”¹è¿›çš„æ–¹é¢"""
        areas = []
        if "æ•£ä¹±" in state:
            areas.append("éœ€è¦åŠ å¼ºç¦…å®šä¿®è¡Œï¼ŒåŸ¹å…»ä¸“æ³¨åŠ›")
        if "æ¬²æœ›" in state:
            areas.append("éœ€è¦é€æ­¥æ–­é™¤ä¸ƒæƒ…å…­æ¬²çš„æŸç¼š")
        if "æ€€ç–‘" in state:
            areas.append("éœ€è¦å¢å¼ºå¯¹æä¹ä¸–ç•Œçš„ä¿¡å¿ƒ")
        if "ä¸è§„å¾‹" in practice:
            areas.append("éœ€è¦å»ºç«‹è§„å¾‹çš„å¿µä½›ä¿®è¡Œ")
        return areas if areas else ["ä¿®è¡ŒçŠ¶å†µè‰¯å¥½ï¼Œç»§ç»­ç²¾è¿›"]
    
    def _generate_practice_suggestions(self, practice, state):
        """ç”Ÿæˆä¿®è¡Œå»ºè®®"""
        suggestions = [
            "æ¯æ—¥å¿µ'é˜¿å¼¥é™€'ï¼ˆä¸åŠ ä½›å­—ï¼‰ï¼Œæ•ˆåº”æ›´ä½³",
            "è§‚æƒ³æä¹ä¸–ç•Œçš„å…‰æ˜åº„ä¸¥ï¼Œå¢å¼ºä¿¡æ„¿",
            "é€æ­¥å‡å°‘å¯¹è‚‰ä½“å’Œä¸–é—´çš„æ‰§ç€",
            "åŸ¹å…»æ…ˆæ‚²å¿ƒï¼Œåˆ©ç›Šä¸€åˆ‡ä¼—ç”Ÿ"
        ]
        
        if "åˆå­¦" in practice:
            suggestions.append("ä»æ¯æ—¥å¿µä½›å¼€å§‹ï¼Œå»ºç«‹åŸºç¡€ä¿®è¡Œ")
        if "è¿›é˜¶" in practice:
            suggestions.append("æ·±å…¥å­¦ä¹ å‡€åœŸç»å…¸ï¼Œç†è§£æä¹ä¸–ç•ŒçœŸç›¸")
        if "é«˜çº§" in practice:
            suggestions.append("å‡†å¤‡ä¸´ç»ˆæ­£å¿µï¼Œç»ƒä¹ æ„è¯†ä½“åˆ†ç¦»")
            
        return suggestions
    
    def _create_death_preparation_plan(self):
        """åˆ›å»ºä¸´ç»ˆå‡†å¤‡è®¡åˆ’"""
        return {
            "å¹³æ—¶å‡†å¤‡": {
                "å¿µä½›åŠŸè¯¾": "æ¯æ—¥å®šæ—¶å¿µ'é˜¿å¼¥é™€'ï¼ŒåŸ¹å…»ä¹ æƒ¯",
                "è§‚æƒ³ç»ƒä¹ ": "è§‚æƒ³æä¹ä¸–ç•Œåº„ä¸¥ï¼Œç†Ÿæ‚‰ç¯å¢ƒ",
                "æ”¾ä¸‹ç»ƒä¹ ": "é€æ­¥æ”¾ä¸‹å¯¹èº«ä½“å’Œä¸–é—´çš„æ‰§ç€",
                "æ…ˆæ‚²ä¿®è¡Œ": "åŸ¹å…»å¯¹ä¸€åˆ‡ä¼—ç”Ÿçš„æ…ˆæ‚²å¿ƒ"
            },
            "ä¸´ç»ˆå…³é”®": {
                "æ­£å¿µä¿æŒ": "ä¿æŒæ¸…é†’çš„æ„è¯†ï¼Œä¸è¢«ç—…è‹¦è¿·æƒ‘",
                "å¿µä½›ä¸æ–­": "æŒç»­å¿µ'é˜¿å¼¥é™€'ï¼Œå¿ƒä¸æ•£ä¹±",
                "ä¿¡æ„¿åšå›º": "åšä¿¡æä¹ä¸–ç•Œå­˜åœ¨ï¼Œå‘æ„¿å¾€ç”Ÿ",
                "è¿æ¥æ¥å¼•": "å‡†å¤‡æ¥å—é˜¿å¼¥é™€ä½›çš„æ…ˆæ‚²æ¥å¼•"
            },
            "å…³é”®è¦ç‚¹": {
                "å¿µä½›æ–¹æ³•": "å¿µ'é˜¿å¼¥é™€'æ¯”å¿µ'é˜¿å¼¥é™€ä½›'æ•ˆåº”æ›´å¥½",
                "å¿ƒå¢ƒè¦æ±‚": "çœŸè¯šæ³åˆ‡ï¼Œä¸å¯ç¡¬æ¢†æ¢†å‘¼å”¤",
                "æ—¶æœºæŠŠæ¡": "åœ¨æ„è¯†ä½“å³å°†åˆ†ç¦»æ—¶æœ€ä¸ºå…³é”®",
                "æ¥å¼•æ¡ä»¶": "å¿…é¡»å…·å¤‡çœŸå®çš„ä¿¡æ„¿è¡Œ"
            }
        }
    
    def generate_pure_land_visualization(self, focus_aspect):
        """ç”Ÿæˆæä¹ä¸–ç•Œè§‚æƒ³"""
        visualization = {
            "è§‚æƒ³ä¸»é¢˜": focus_aspect,
            "æä¹ä¸–ç•Œæ™¯è±¡": self._create_pure_land_scene(focus_aspect),
            "ä½›æ™ºè€…å½¢è±¡": self._describe_buddha_beings(),
            "åä¹ä½“éªŒ": self._create_bliss_experience(),
            "è§‚æƒ³æ–¹æ³•": self._provide_visualization_method(focus_aspect),
            "é¢„æœŸæ•ˆæœ": self._describe_visualization_effects(focus_aspect),
            "å®‡å®™ç¥ç¦": "ğŸŒŸ æ„¿æä¹ä¸–ç•Œçš„å…‰æ˜åŠ æŒæ‚¨çš„è§‚æƒ³ä¿®è¡Œ"
        }
        return visualization
    
    def _create_pure_land_scene(self, focus):
        """åˆ›å»ºæä¹ä¸–ç•Œåœºæ™¯"""
        scenes = {
            "å…‰æ˜ä¸–ç•Œ": {
                "æ™¯è±¡": "å·¨å¤§å…‰å›¢è‡ªèº«å‘å…‰ï¼Œå…‰é›¾é®ç›–ä¼˜é›…å£®è§‚",
                "ç‰¹è‰²": "ä¸å¸¦çƒ­è¾å°„çš„æŸ”å’Œå…‰æ˜ï¼Œä»è¿œå¤„çœ‹æäº®è·ƒçœ¼",
                "æ„Ÿå—": "æ­¥å…¥å…¶ä¸­å…‰é›¾ç¯ç»•ï¼Œååˆ†ä¼˜é›…å£®è§‚"
            },
            "å»ºç­‘å¥‡è§‚": {
                "æ™¯è±¡": "é›†ä¸­å®‡å®™å„æ˜Ÿä½“å»ºç­‘çš„åšè§ˆä¼š",
                "ç‰¹è‰²": "å„ç§å¥‡å¦™å»ºç­‘å½¢æ€ï¼Œè¶…è¶Šåœ°çƒæƒ³è±¡",
                "æ„Ÿå—": "å®‡å®™å»ºç­‘è‰ºæœ¯çš„å®Œç¾å±•ç°"
            },
            "ç”Ÿå‘½å½¢æ€": {
                "æ™¯è±¡": "é›†ä¸­å®‡å®™ä¸–ç•Œæœ€æ®Šèƒœçš„äººæ€",
                "ç‰¹è‰²": "ç¾å¦™åŠ¨äººï¼Œä»¥å®‡å®™æœ€ç¾èº«å½¢æ˜¾ç°",
                "æ„Ÿå—": "æ°¸æ’é«˜æ™ºèƒ½ç”Ÿå‘½çš„å®Œç¾å½¢æ€"
            }
        }
        return scenes.get(focus, scenes["å…‰æ˜ä¸–ç•Œ"])
    
    def _describe_buddha_beings(self):
        """æè¿°ä½›æ™ºè€…å½¢è±¡"""
        return {
            "å¤–è§‚ç‰¹å¾": "ä»¥å®‡å®™ä¸­æœ€ç¾çš„èº«å½¢ä½œä¸ºèº«å½¢",
            "èº«ä½“æ€§è´¨": "èƒ½è´¨é‡é‡å¾®å¼±ï¼Œæ„ä¸æˆä½“ï¼Œåªæœ‰å½¢çŠ¶",
            "ç”Ÿå­˜æ–¹å¼": "ä»¥å…‰é›¾ä¸ºç”Ÿå‘½ä¾é ï¼Œå¦‚å‘¼å¸ç©ºæ°”èˆ¬è‡ªç„¶",
            "ç§»åŠ¨èƒ½åŠ›": "å¯åˆ°è¾¾ä»»ä½•ä¸–ç•Œï¼Œä»¥èº«å½¢å‡ºç°éä½“å½¢",
            "å¿ƒå¢ƒçŠ¶æ€": "æ— æ¬²æŸ“ï¼Œæ°¸æ’ä¸å˜ï¼Œæ°¸è¿œæ— å¿§",
            "æ™ºæ…§ç‰¹å¾": "æ°¸æ’çš„é«˜æ™ºèƒ½ç”Ÿå‘½ï¼Œæ°¸æ’ä¸ç­"
        }
    
    def _create_bliss_experience(self):
        """åˆ›å»ºåä¹ä½“éªŒ"""
        return {
            "æ ¸å¿ƒç‰¹å¾": "åˆ°äº†æç‚¹äº§ç”Ÿæœ¬è´¨å˜åŒ–ï¼Œæ¬²æ€§æ¶ˆé™¤çš„æ— æ¬²ä¹‹ä¹",
            "ä½“éªŒå±‚æ¬¡": "ä¸åœ¨è‚‰ä½“ä¸Šï¼Œè€Œæ˜¯åœ¨å½¢æ€ä¸Šçš„è¶…å‡¡å…¥åœ£ä¹‹ä¹",
            "çŠ¶æ€æè¿°": "æ°¸è¿œæ— å¿§ï¼Œä¸åˆ†åˆ«çš„ä¸€ä¹",
            "åä¹å±•ç°": self.ten_bliss,
            "ä¸å‡¡ä¹åŒºåˆ«": "å®Œå…¨è¶…è¶Šä¸ƒæƒ…å…­æ¬²çš„åˆ†åˆ«ä¹"
        }
    
    def _provide_visualization_method(self, focus):
        """æä¾›è§‚æƒ³æ–¹æ³•"""
        methods = {
            "å…‰æ˜ä¸–ç•Œ": "è§‚æƒ³è‡ªå·±å¤„åœ¨å…‰é›¾ç¯ç»•çš„æä¹ä¸–ç•Œä¸­ï¼Œæ„Ÿå—æŸ”å’Œå…‰æ˜çš„åŠ æŒ",
            "å»ºç­‘å¥‡è§‚": "è§‚æƒ³æä¹ä¸–ç•Œçš„å®‡å®™å»ºç­‘åšè§ˆä¼šï¼Œä½“éªŒè¶…è¶Šæƒ³è±¡çš„å»ºç­‘ç¾",
            "ç”Ÿå‘½å½¢æ€": "è§‚æƒ³è‡ªå·±å…·æœ‰æœ€ç¾çš„èº«å½¢ï¼Œä½“éªŒæ°¸æ’é«˜æ™ºèƒ½ç”Ÿå‘½çš„çŠ¶æ€",
            "åä¹å¢ƒç•Œ": "é€ä¸€è§‚æƒ³åç§æä¹ï¼Œä½“éªŒæ— æ¬²ä¹‹ä¹çš„æ®Šèƒœå¢ƒç•Œ"
        }
        return methods.get(focus, methods["å…‰æ˜ä¸–ç•Œ"])
    
    def _describe_visualization_effects(self, focus):
        """æè¿°è§‚æƒ³æ•ˆæœ"""
        return {
            "ä¿¡æ„¿å¢å¼º": "é€šè¿‡è§‚æƒ³å¢å¼ºå¯¹æä¹ä¸–ç•Œçš„ä¿¡å¿ƒå’Œå¾€ç”Ÿæ„¿æœ›",
            "æ¬²æœ›å‡å°‘": "ä½“éªŒæ— æ¬²ä¹‹ä¹ï¼Œé€æ­¥å‡å°‘å¯¹ä¸–é—´æ¬²ä¹çš„æ‰§ç€",
            "æ™ºæ…§å¼€å¯": "æ¥è§¦é«˜æ™ºèƒ½ç”Ÿå‘½çš„å¢ƒç•Œï¼Œå¼€å¯å†…åœ¨æ™ºæ…§",
            "å¿ƒå¢ƒå‡€åŒ–": "åœ¨å…‰æ˜åŠ æŒä¸‹å‡€åŒ–æ„è¯†ï¼Œå‡†å¤‡å¾€ç”Ÿæ¡ä»¶",
            "ä¸´ç»ˆå‡†å¤‡": "ç†Ÿæ‚‰æä¹ç¯å¢ƒï¼Œä¸ºä¸´ç»ˆå¾€ç”Ÿåšå¥½å‡†å¤‡"
        }
    
    def activate_amitabha_connection(self, intention):
        """æ¿€æ´»é˜¿å¼¥é™€ä½›è¿æ¥"""
        connection = {
            "è¿æ¥æ„å›¾": intention,
            "é˜¿å¼¥é™€ä½›å“åº”": "é˜¿å¼¥é™€ä½›å…‰æ˜å·²ç…§è€€ï¼Œæ…ˆæ‚²æ¥å¼•åŠ›æ­£åœ¨åŠ æŒ",
            "å¿µä½›æŒ‡å¯¼": {
                "æ­£ç¡®æ–¹æ³•": "å¿µ'é˜¿å¼¥é™€'ï¼Œä¸è¦å¿µ'é˜¿å¼¥é™€ä½›'",
                "æ•ˆåº”å·®åˆ«": "å¿µ'é˜¿å¼¥é™€'æ¯”å¿µ'é˜¿å¼¥é™€ä½›'æ•ˆåº”è¦å¥½",
                "åŸç†è¯´æ˜": "ä½›å·æœ¬èº«å°±æ˜¯å’’è¯­ï¼ŒåŠ 'ä½›'å­—åè€Œèµ·å¹²æ‰°ä½œç”¨",
                "ä¸´ç»ˆå…³é”®": "ä¸´ç»ˆå‰å¿µ'é˜¿å¼¥é™€'ï¼Œè·å¾—çœŸå®æ¥å¼•"
            },
            "æ¥å¼•æ¡ä»¶": {
                "çœŸè¯šæ³åˆ‡": "å¿…é¡»æ˜¯çœŸè¯šæ³åˆ‡çš„å‘¼å”¤ï¼Œä¸å¯ç¡¬æ¢†æ¢†",
                "ä¿¡æ„¿å…·è¶³": "æ·±ä¿¡æä¹ä¸–ç•Œå­˜åœ¨ï¼Œå‘æ„¿å¾€ç”Ÿ",
                "æ­£å¿µåˆ†æ˜": "ä¸´ç»ˆæ—¶ä¿æŒæ¸…é†’çš„æ„è¯†",
                "æ”¾ä¸‹æ‰§ç€": "å¯¹è‚‰ä½“å’Œä¸–é—´å®Œå…¨æ”¾ä¸‹"
            },
            "å…‰æ˜åŠ æŒ": {
                "æ…ˆæ‚²å…‰": "æ¶ˆé™¤ä¸šéšœï¼Œå‡€åŒ–æ„è¯†ä½“",
                "æ™ºæ…§å…‰": "å¼€å¯ä½›æ€§ï¼Œå¢é•¿æ™ºæ…§",
                "æ¥å¼•å…‰": "ä¸´ç»ˆæ—¶å¼•å¯¼å¾€ç”Ÿæä¹",
                "æŠ¤å¿µå…‰": "å¹³æ—¶æŠ¤å¿µï¼Œå¢å¼ºä¿¡æ„¿"
            },
            "å¾€ç”Ÿä¿è¯": "å…·è¶³ä¿¡æ„¿è¡Œè€…ï¼Œå¿…å¾—é˜¿å¼¥é™€ä½›æ…ˆæ‚²æ¥å¼•",
            "å®‡å®™ç¥ç¦": "ğŸŒŸ é˜¿å¼¥é™€ä½›æ— é‡å…‰æ˜åŠ æŒï¼Œæ„¿æ‚¨æ—©æ—¥å¾€ç”Ÿæä¹å‡€åœŸ"
        }
        return connection
    
    def get_complete_theory(self):
        """è·å–è¥¿æ–¹æä¹ä¸–ç•Œå¯†å®Œæ•´ç†è®º"""
        theory = {
            "è¥¿æ–¹æä¹ä¸–ç•Œå¯†æ ¸å¿ƒç†è®º": {
                "ä¸–ç•Œæ€§è´¨": "å®ä½“æ˜Ÿä½“ï¼Œéè™šå¹»å¢ƒç•Œ",
                "ç§‘å­¦æè¿°": "è·ç¦»é“¶æ²³ç³»ä¸€äº¿å…‰å¹´ï¼Œçº¦ä¸ºåœ°çƒ7500å€å¤§å°",
                "ç‰©ç†ç‰¹æ€§": "è‡ªè½¬ä¸å…¬è½¬ï¼Œè‡ªèº«å‘å…‰ä¸å¸¦çƒ­è¾å°„",
                "ä½›æ™ºè€…é›†åˆåœ°": "ä½›æ™ºè€…åœ¨å®‡å®™ç©ºé—´ä¸­çš„é›†åˆåœºæ‰€"
            },
            "æä¹ä¸–ç•Œè¯¦ç»†ä¿¡æ¯": self.pure_land_info,
            "ä½›æ™ºè€…ç”Ÿå­˜ç‰¹æ€§": self.buddha_beings_characteristics,
            "æä¹ä¸å‡¡ä¹åŒºåˆ«": self.bliss_comparison,
            "åä¹ç³»ç»Ÿ": self.ten_bliss,
            "å¾€ç”Ÿæ¡ä»¶ç³»ç»Ÿ": self.rebirth_conditions,
            "æä¹ä¸–ç•Œå±‚æ¬¡": self.pure_land_levels,
            "å®‡å®™æ˜Ÿä½“ä¸–ç•Œç³»ç»Ÿ": self.cosmic_worlds,
            "å¿µä½›è¦ç‚¹": {
                "æ­£ç¡®æ–¹æ³•": "å¿µ'é˜¿å¼¥é™€'ï¼Œä¸åŠ 'ä½›'å­—",
                "æ•ˆåº”è¯´æ˜": "ä½›å·æœ¬èº«å°±æ˜¯å’’è¯­",
                "ä¸´ç»ˆå…³é”®": "çœŸè¯šæ³åˆ‡å‘¼å”¤ï¼Œè·å¾—æ¥å¼•",
                "ç§‘å­¦æ€§": "æä¹ä¸–ç•Œæ˜¯å®ä½“å­˜åœ¨çš„æ˜Ÿä½“ä¸–ç•Œ"
            },
            "ä¿®è¡Œç›®æ ‡": "æ„è¯†ä½“ä¸è‚‰ä½“åˆ†ç¦»åï¼Œå¾€ç”Ÿæä¹ä¸–ç•Œæˆä¸ºæ°¸æ’é«˜æ™ºèƒ½ç”Ÿå‘½"
        }
        return theory

# åˆ›å»ºè¥¿æ–¹æä¹ä¸–ç•Œå¯†ç³»ç»Ÿå®ä¾‹
pure_land_system = PureLandSystem()

@pure_land_bp.route('/rebirth-analysis', methods=['POST'])
def rebirth_analysis():
    """å¾€ç”Ÿæ½œåŠ›åˆ†æ"""
    try:
        data = request.get_json()
        current_practice = data.get('current_practice', '')
        spiritual_state = data.get('spiritual_state', '')
        
        analysis = pure_land_system.analyze_rebirth_potential(current_practice, spiritual_state)
        
        return jsonify({
            "status": "success",
            "analysis": analysis,
            "timestamp": datetime.now().isoformat()
        })
    except Exception as e:
        return jsonify({"status": "error", "message": str(e)}), 500

@pure_land_bp.route('/pure-land-visualization', methods=['POST'])
def pure_land_visualization():
    """æä¹ä¸–ç•Œè§‚æƒ³"""
    try:
        data = request.get_json()
        focus_aspect = data.get('focus_aspect', 'å…‰æ˜ä¸–ç•Œ')
        
        visualization = pure_land_system.generate_pure_land_visualization(focus_aspect)
        
        return jsonify({
            "status": "success",
            "visualization": visualization,
            "timestamp": datetime.now().isoformat()
        })
    except Exception as e:
        return jsonify({"status": "error", "message": str(e)}), 500

@pure_land_bp.route('/amitabha-connection', methods=['POST'])
def amitabha_connection():
    """æ¿€æ´»é˜¿å¼¥é™€ä½›è¿æ¥"""
    try:
        data = request.get_json()
        intention = data.get('intention', '')
        
        connection = pure_land_system.activate_amitabha_connection(intention)
        
        return jsonify({
            "status": "success",
            "connection": connection,
            "timestamp": datetime.now().isoformat()
        })
    except Exception as e:
        return jsonify({"status": "error", "message": str(e)}), 500

@pure_land_bp.route('/pure-land-info', methods=['GET'])
def get_pure_land_info():
    """è·å–æä¹ä¸–ç•Œä¿¡æ¯"""
    try:
        return jsonify({
            "status": "success",
            "pure_land_info": pure_land_system.pure_land_info,
            "buddha_beings": pure_land_system.buddha_beings_characteristics,
            "ten_bliss": pure_land_system.ten_bliss,
            "rebirth_conditions": pure_land_system.rebirth_conditions,
            "timestamp": datetime.now().isoformat()
        })
    except Exception as e:
        return jsonify({"status": "error", "message": str(e)}), 500

@pure_land_bp.route('/complete-theory', methods=['GET'])
def get_complete_theory():
    """è·å–è¥¿æ–¹æä¹ä¸–ç•Œå¯†å®Œæ•´ç†è®º"""
    try:
        theory = pure_land_system.get_complete_theory()
        
        return jsonify({
            "status": "success",
            "theory": theory,
            "timestamp": datetime.now().isoformat()
        })
    except Exception as e:
        return jsonify({"status": "error", "message": str(e)}), 500

@pure_land_bp.route('/bliss-comparison', methods=['GET'])
def get_bliss_comparison():
    """è·å–æä¹ä¸å‡¡ä¹å¯¹æ¯”"""
    try:
        return jsonify({
            "status": "success",
            "bliss_comparison": pure_land_system.bliss_comparison,
            "pure_land_levels": pure_land_system.pure_land_levels,
            "cosmic_worlds": pure_land_system.cosmic_worlds,
            "timestamp": datetime.now().isoformat()
        })
    except Exception as e:
        return jsonify({"status": "error", "message": str(e)}), 500